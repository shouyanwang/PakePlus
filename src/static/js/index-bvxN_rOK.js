import{c as He,p as Ie,d as Ne,e as he,f as ze,h as Ge,i as Qe,j as Je,k as Ke,l as Me,m as We,n as Xe,o as Ye,q as Ze}from"./building-D9WBgJ6R.js";import{c as el}from"./bedType-B8KJEs04.js";import{g as ll}from"./roomType-10Irh1uQ.js";import{_ as al,d as ol,r as d,e as _,D as ie,c as k,o as n,f as s,h as l,E as b,i as a,A as c,j as p,F as E,v as q,t as P,B as re}from"./index-gubRP18q.js";const tl={class:"search-form"},dl={class:"dialog-footer"},nl={class:"level"},ul={class:"title"},sl={class:"room-list"},il={class:"top"},rl={class:"room-no"},ml={class:"bottom"},pl={class:"room-info"},vl={class:"item"},fl={class:"item"},_l={class:"room-button"},cl={class:"level"},gl={class:"dialog-footer"},yl={class:"bed-info"},bl={class:"top"},Vl={class:"room-no"},Cl={key:0,class:"bed-info-list"},kl={class:"index"},Rl={class:"dialog-footer"},Al={__name:"index",setup(wl){const{proxy:v}=ol(),R=d({keyword:"",status:"",page:1,per_page:10}),I=d(!1),W=d(0),X=d([]),me=()=>({backgroundColor:"#F6F8FF",color:"#C5C5C5"}),D=async()=>{I.value=!0;const t=await He(R.value);I.value=!1,X.value=t.data.data,W.value=t.data.total};D();const pe=()=>{R.value.page=1,D()},ve=d(null),f=d({name:"",floor:""}),fe=d({name:[{required:!0,message:"请输入楼宇名称",trigger:"blur"}],floor:[{required:!0,message:"请输入楼层",trigger:"change"}]}),w=d(!1),N=d(""),h=()=>{f.value.id="",Object.keys(f.value).forEach(t=>{f.value[t]=""}),f.value.status=1,v.resetForm("formRef")},_e=()=>{h(),N.value="新增",w.value=!0},ce=async t=>{h();const e=await he({id:t.id});w.value=!0,N.value="修改",Object.keys(f.value).forEach(i=>{f.value[i]=e.data[i]}),f.value.id=t.id},ge=()=>{w.value=!1,h()},ye=()=>{v.$refs.formRef.validate(async t=>{t&&(f.value.id!=""?(await Ie(f.value),v.$modal.msgSuccess("修改成功"),w.value=!1,D()):(await Ne(f.value),v.$modal.msgSuccess("新增成功"),w.value=!1,D()))})},be=t=>{v.$modal.confirm("是否确认删除?").then(async()=>{await ze({id:t.id}),v.$modal.msgSuccess("删除成功"),D()}).catch(()=>{})},z=d(!1),G=d([]),B=d(""),L=async()=>{const t=await Ye({building_id:B.value});G.value=t.data},Ve=async t=>{B.value=t.id,await L(),z.value=!0},T=d(!1),Q=d(""),Ce=d(null),u=d({name:"",floor:"",type:"",area_num:"",order:""}),ke=d({name:[{required:!0,message:"请输入名称",trigger:"blur"}],floor:[{required:!0,message:"请输入楼层",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}]}),Y=()=>{u.value.id="",Object.keys(u.value).forEach(t=>{u.value[t]=""}),v.resetForm("addRoomformRef")},Z=d([]),ee=async()=>{const t=await ll();Z.value=t.data},le=async()=>{Y(),Q.value="新增房间",await ee(),T.value=!0},Re=async t=>{const e=await Qe({id:t.id});Object.keys(u.value).forEach(i=>{u.value[i]=e.data[i]}),u.value.type=e.data.type.id,u.value.id=t.id,Q.value="修改房间",await ee(),T.value=!0},Ae=()=>{T.value=!1,Y()},we=()=>{v.$refs.addRoomformRef.validate(async t=>{t&&(u.value.id!=""?(await Je({building_id:B.value,...u.value}),v.$modal.msgSuccess("修改成功"),T.value=!1,L()):(await Ke({building_id:B.value,...u.value}),v.$modal.msgSuccess("新增成功"),T.value=!1,L()))})},Be=async t=>{v.$modal.confirm("是否确认删除房间?").then(async()=>{await Ge({id:t.id}),v.$modal.msgSuccess("删除成功"),L()}).catch(()=>{})},O=d(!1),j=d([]),x=d(""),ae=d(""),J=async()=>{const t=await Ze({building_id:B.value,room_id:x.value});j.value=t.data},Te=async t=>{x.value=t.id,ae.value=t.name,await J(),O.value=!0},$=d(!1),K=d(""),oe=d([]),te=async()=>{const t=await el();oe.value=t.data},$e=d(null),r=d({name:"",type:"",order:""}),Ue=d({name:[{required:!0,message:"请输入名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}]}),M=()=>{r.value.id="",Object.keys(r.value).forEach(t=>{r.value[t]=""}),v.resetForm("addBedformRef")},Ee=async()=>{M(),K.value="新增床位",await te(),$.value=!0},De=async t=>{M(),await te(),K.value="修改床位";const e=await Me({id:t.id});Object.keys(r.value).forEach(i=>{r.value[i]=e.data[i]}),r.value.type=e.data.type.id,r.value.id=t.id,$.value=!0},Se=()=>{$.value=!1,M()},Pe=()=>{v.$refs.addBedformRef.validate(async t=>{t&&(r.value.id!=""?(await We({building_id:B.value,room_id:x.value,...r.value}),v.$modal.msgSuccess("修改成功"),$.value=!1,J()):(await Xe({building_id:B.value,room_id:x.value,...r.value}),v.$modal.msgSuccess("新增成功"),$.value=!1,J()))})};return(t,e)=>{const i=_("el-input"),y=_("el-form-item"),g=_("el-col"),m=_("el-button"),U=_("el-row"),H=_("el-form"),F=_("Dialog"),S=_("el-table-column"),Fe=_("el-table"),qe=_("Pagination"),Le=_("Close"),Oe=_("el-icon"),de=_("el-empty"),ne=_("el-option"),ue=_("el-select"),V=ie("hasPermi"),je=ie("loading");return n(),k(E,null,[s("div",tl,[l(H,{model:R.value,ref:"queryRef"},{default:a(()=>[l(U,{gutter:30},{default:a(()=>[l(g,{span:8},{default:a(()=>[l(y,{label:"楼宇名称",prop:"name"},{default:a(()=>[l(i,{modelValue:R.value.name,"onUpdate:modelValue":e[0]||(e[0]=o=>R.value.name=o),placeholder:"请输入楼宇名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(g,{span:8},{default:a(()=>[l(y,null,{default:a(()=>[b((n(),c(m,{type:"primary",icon:"Search",onClick:pe},{default:a(()=>e[19]||(e[19]=[p("查询")])),_:1,__:[19]})),[[V,["GET.building"]]]),b((n(),c(m,{icon:"plus",type:"primary",onClick:_e},{default:a(()=>e[20]||(e[20]=[p("新增")])),_:1,__:[20]})),[[V,["POST.building"]]])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),l(F,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=o=>w.value=o),title:N.value,width:"936"},{footer:a(()=>[s("div",dl,[l(m,{onClick:ge},{default:a(()=>e[21]||(e[21]=[p("取消")])),_:1,__:[21]}),l(m,{type:"primary",onClick:ye},{default:a(()=>e[22]||(e[22]=[p(" 确认 ")])),_:1,__:[22]})])]),default:a(()=>[l(H,{model:f.value,rules:fe.value,ref_key:"formRef",ref:ve,"label-position":"top"},{default:a(()=>[l(U,{gutter:52},{default:a(()=>[l(g,{span:12},{default:a(()=>[l(y,{label:"楼宇名称",prop:"name"},{default:a(()=>[l(i,{modelValue:f.value.name,"onUpdate:modelValue":e[1]||(e[1]=o=>f.value.name=o),placeholder:"请输入楼宇名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,{span:12},{default:a(()=>[l(y,{label:"楼层",prop:"floor"},{default:a(()=>[l(i,{modelValue:f.value.floor,"onUpdate:modelValue":e[2]||(e[2]=o=>f.value.floor=o),placeholder:"请输入楼层"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),b((n(),c(Fe,{class:"base-info-table",data:X.value,"header-cell-style":me},{default:a(()=>[l(S,{prop:"name",label:"楼宇名称",align:"center"}),l(S,{prop:"floor",label:"楼层",align:"center"}),l(S,{prop:"room",label:"房间数量",align:"center"}),l(S,{prop:"bed0",label:"空闲床位",align:"center"}),l(S,{prop:"bed1",label:"已入住",align:"center"}),l(S,{prop:"action",label:"操作",align:"center",width:"260"},{default:a(({row:o})=>[l(m,{type:"primary",plain:"",onClick:C=>Ve(o)},{default:a(()=>e[23]||(e[23]=[p("房间管理")])),_:2,__:[23]},1032,["onClick"]),b((n(),c(m,{type:"primary",plain:"",onClick:C=>ce(o)},{default:a(()=>e[24]||(e[24]=[p("修改")])),_:2,__:[24]},1032,["onClick"])),[[V,["PATCH.building/{building}"]]]),b((n(),c(m,{type:"danger",plain:"",onClick:C=>be(o)},{default:a(()=>e[25]||(e[25]=[p("删除")])),_:2,__:[25]},1032,["onClick"])),[[V,["DELETE.building/{building}"]]])]),_:1})]),_:1},8,["data"])),[[je,I.value]]),l(qe,{total:W.value,layout:"total, prev, pager, next, jumper",page:R.value.page,"onUpdate:page":e[4]||(e[4]=o=>R.value.page=o),limit:R.value.per_page,"onUpdate:limit":e[5]||(e[5]=o=>R.value.per_page=o),onPagination:D},null,8,["total","page","limit"]),l(F,{modelValue:z.value,"onUpdate:modelValue":e[18]||(e[18]=o=>z.value=o),title:"房间管理",width:"1275",padding:"0"},{default:a(()=>[G.value.length>0?(n(!0),k(E,{key:0},q(G.value,(o,C)=>(n(),k("div",{key:C},[s("div",nl,[s("div",ul,P(o.floor)+"F",1),b((n(),c(m,{type:"primary",icon:"plus",onClick:le},{default:a(()=>e[26]||(e[26]=[p("新增房间")])),_:1,__:[26]})),[[V,["POST.room"]]])]),s("div",sl,[(n(!0),k(E,null,q(o.liat,(A,xe)=>(n(),k("div",{class:"room-item",key:xe},[s("div",il,[s("div",rl,P(A.name),1),b((n(),c(Oe,{color:"#AEC1FF",onClick:se=>Be(A)},{default:a(()=>[l(Le)]),_:2},1032,["onClick"])),[[V,["DELETE.room/{room}"]]])]),s("div",ml,[s("div",pl,[s("div",vl,"床位："+P(A.bed0+A.bed1),1),s("div",fl,"已住："+P(A.bed1),1)]),s("div",_l,[b((n(),c(m,{type:"primary",plain:"",onClick:se=>Re(A)},{default:a(()=>e[27]||(e[27]=[p("编辑房间")])),_:2,__:[27]},1032,["onClick"])),[[V,["PATCH.room/{room}"]]]),b((n(),c(m,{type:"primary",onClick:se=>Te(A)},{default:a(()=>e[28]||(e[28]=[p("编辑床位")])),_:2,__:[28]},1032,["onClick"])),[[V,["PATCH.bed/{bed}"]]])])])]))),128))])]))),128)):(n(),k(E,{key:1},[s("div",cl,[e[30]||(e[30]=s("div",{class:"title"},null,-1)),b((n(),c(m,{type:"primary",icon:"plus",onClick:le},{default:a(()=>e[29]||(e[29]=[p("新增房间")])),_:1,__:[29]})),[[V,["POST.room"]]])]),l(de,{"image-size":200})],64)),l(F,{modelValue:T.value,"onUpdate:modelValue":e[11]||(e[11]=o=>T.value=o),title:Q.value,width:"937"},{footer:a(()=>[s("div",gl,[l(m,{onClick:Ae},{default:a(()=>e[31]||(e[31]=[p("取消")])),_:1,__:[31]}),l(m,{type:"primary",onClick:we},{default:a(()=>e[32]||(e[32]=[p(" 确认 ")])),_:1,__:[32]})])]),default:a(()=>[l(H,{model:u.value,rules:ke.value,ref_key:"addRoomformRef",ref:Ce,"label-position":"top"},{default:a(()=>[l(U,{gutter:56},{default:a(()=>[l(g,{span:12},{default:a(()=>[l(y,{label:"房间名称",prop:"name"},{default:a(()=>[l(i,{modelValue:u.value.name,"onUpdate:modelValue":e[6]||(e[6]=o=>u.value.name=o),placeholder:"请输入房间名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,{span:12},{default:a(()=>[l(y,{label:"房间类型",prop:"type"},{default:a(()=>[l(ue,{modelValue:u.value.type,"onUpdate:modelValue":e[7]||(e[7]=o=>u.value.type=o),placeholder:"请选择房间类型"},{default:a(()=>[(n(!0),k(E,null,q(Z.value,(o,C)=>(n(),c(ne,{key:C,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(U,{gutter:56},{default:a(()=>[l(g,{span:12},{default:a(()=>[l(y,{label:"房间楼层",prop:"floor"},{default:a(()=>[l(i,{modelValue:u.value.floor,"onUpdate:modelValue":e[8]||(e[8]=o=>u.value.floor=o),type:"number",placeholder:"请输入房间楼层"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,{span:12},{default:a(()=>[l(y,{label:"房间面积",prop:"area_num"},{default:a(()=>[l(i,{modelValue:u.value.area_num,"onUpdate:modelValue":e[9]||(e[9]=o=>u.value.area_num=o),type:"number",placeholder:"请输入房间面积"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(U,{gutter:56},{default:a(()=>[l(g,{span:12},{default:a(()=>[l(y,{label:"排序",prop:"order"},{default:a(()=>[l(i,{modelValue:u.value.order,"onUpdate:modelValue":e[10]||(e[10]=o=>u.value.order=o),type:"number",placeholder:"请输入排序"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,{span:12})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),l(F,{modelValue:O.value,"onUpdate:modelValue":e[12]||(e[12]=o=>O.value=o),width:"937",title:"编辑床位",onClose:e[13]||(e[13]=o=>O.value=!1)},{default:a(()=>[s("div",null,[s("div",yl,[s("div",bl,[s("div",Vl,P(ae.value),1),b((n(),c(m,{type:"primary",icon:"plus",onClick:Ee},{default:a(()=>e[33]||(e[33]=[p("新增床位")])),_:1,__:[33]})),[[V,["POST.bed"]]])]),j.value.length>0?(n(),k("div",Cl,[(n(!0),k(E,null,q(j.value,(o,C)=>(n(),k("div",{class:"bed-info-item",key:C},[s("div",kl,P(C+1),1),b((n(),c(m,{type:"primary",plain:"",onClick:A=>De(o)},{default:a(()=>e[34]||(e[34]=[p("床位信息")])),_:2,__:[34]},1032,["onClick"])),[[V,["PATCH.bed/{bed}"]]])]))),128))])):re("",!0)]),j.value.length<=0?(n(),c(de,{key:0,"image-size":200})):re("",!0)])]),_:1},8,["modelValue"]),l(F,{modelValue:$.value,"onUpdate:modelValue":e[17]||(e[17]=o=>$.value=o),title:K.value,width:"937"},{footer:a(()=>[s("div",Rl,[l(m,{onClick:Se},{default:a(()=>e[35]||(e[35]=[p("取消")])),_:1,__:[35]}),l(m,{type:"primary",onClick:Pe},{default:a(()=>e[36]||(e[36]=[p(" 确认 ")])),_:1,__:[36]})])]),default:a(()=>[l(H,{model:r.value,rules:Ue.value,ref_key:"addBedformRef",ref:$e,"label-position":"top"},{default:a(()=>[l(U,{gutter:56},{default:a(()=>[l(g,{span:12},{default:a(()=>[l(y,{label:"床位名称",prop:"name"},{default:a(()=>[l(i,{modelValue:r.value.name,"onUpdate:modelValue":e[14]||(e[14]=o=>r.value.name=o),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,{span:12},{default:a(()=>[l(y,{label:"床位类型",prop:"type"},{default:a(()=>[l(ue,{modelValue:r.value.type,"onUpdate:modelValue":e[15]||(e[15]=o=>r.value.type=o),placeholder:"请选择床位类型"},{default:a(()=>[(n(!0),k(E,null,q(oe.value,(o,C)=>(n(),c(ne,{key:C,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(U,{gutter:56},{default:a(()=>[l(g,{span:12},{default:a(()=>[l(y,{label:"排序"},{default:a(()=>[l(i,{modelValue:r.value.order,"onUpdate:modelValue":e[16]||(e[16]=o=>r.value.order=o),type:"number",placeholder:"请输入排序"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,{span:12})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]),_:1},8,["modelValue"])],64)}}},El=al(Al,[["__scopeId","data-v-322162c8"]]);export{El as default};
