import{b as Q}from"./index-C7tsWDCj.js";import{a as W}from"./index-DUIlgPjs.js";import{g as J}from"./epartmene-C8oc6t7Y.js";import{g as K}from"./scaleSet-DAbYo_iF.js";import{g as O}from"./user-B-BoveDY.js";import X from"./Report-CNLukoIc.js";import{_ as Z,r as u,e as r,D as h,c as v,o as p,f as Y,h as e,i as a,F as b,v as D,A as g,E as ee,j as i,t as V}from"./index-B9Da-5fK.js";import"./jspdf.es.min-LKm_IDpI.js";import"./index-Cn7K6gb9.js";const le={class:"search-form"},ae={class:"dialog-footer"},te={__name:"index",setup(oe){const o=u({elder_name:"",phone:"",sex:"",epartmene_id:"",scale_set_id:"",admin_name:"",created_at:"",elder_status:"",page:1,per_page:10}),S=u([]),x=async()=>{const n=await J();S.value=n.data};x();const C=u([]);(async()=>{const n=await K();C.value=n.data})(),x();const U=u([]);(async()=>{const n=await O();U.value=n.data})();const F=u(!1),P=u(0),R=u([]),L=()=>({backgroundColor:"#F6F8FF",color:"#C5C5C5"}),y=async()=>{F.value=!0;const n=await Q(o.value);F.value=!1,R.value=n.data.data,P.value=n.data.total};y();const N=()=>{o.value.page=1,y()},k=u(!1),A=u({}),T=async n=>{const t=await W({id:n.scale_id,result_id:n.id,elder_id:n.elder_id});A.value=t.data,A.value.scale_name=n.scale.name,k.value=!0},w=u(null),$=async()=>{w.value&&await w.value.generatePDF()};return(n,t)=>{const E=r("el-input"),d=r("el-form-item"),s=r("el-col"),m=r("el-option"),c=r("el-select"),B=r("el-row"),j=r("el-date-picker"),f=r("el-button"),q=r("el-form"),_=r("el-table-column"),z=r("el-table"),M=r("Dialog"),G=r("Pagination"),H=h("hasPermi");return p(),v(b,null,[Y("div",le,[e(q,{model:o.value,ref:"queryRef","label-position":"top"},{default:a(()=>[e(B,{gutter:43},{default:a(()=>[e(s,{span:6},{default:a(()=>[e(d,{label:"姓名",prop:"elder_name"},{default:a(()=>[e(E,{modelValue:o.value.elder_name,"onUpdate:modelValue":t[0]||(t[0]=l=>o.value.elder_name=l),placeholder:"请输入长者姓名",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:a(()=>[e(d,{label:"手机号",prop:"phone"},{default:a(()=>[e(E,{modelValue:o.value.phone,"onUpdate:modelValue":t[1]||(t[1]=l=>o.value.phone=l),placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:a(()=>[e(d,{label:"性别",prop:"sex"},{default:a(()=>[e(c,{modelValue:o.value.sex,"onUpdate:modelValue":t[2]||(t[2]=l=>o.value.sex=l),placeholder:"请选择性别",clearable:""},{default:a(()=>[e(m,{label:"男",value:1}),e(m,{label:"女",value:2})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:a(()=>[e(d,{label:"科室",prop:"epartmene_id"},{default:a(()=>[e(c,{modelValue:o.value.epartmene_id,"onUpdate:modelValue":t[3]||(t[3]=l=>o.value.epartmene_id=l),placeholder:"请选择科室",clearable:""},{default:a(()=>[(p(!0),v(b,null,D(S.value,l=>(p(),g(m,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(B,{gutter:43},{default:a(()=>[e(s,{span:6},{default:a(()=>[e(d,{label:"评估类型",prop:"scale_set_id"},{default:a(()=>[e(c,{modelValue:o.value.scale_set_id,"onUpdate:modelValue":t[4]||(t[4]=l=>o.value.scale_set_id=l),placeholder:"请选择评估类型",clearable:""},{default:a(()=>[(p(!0),v(b,null,D(C.value,l=>(p(),g(m,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:a(()=>[e(d,{label:"评估医生",prop:"admin_name"},{default:a(()=>[e(c,{modelValue:o.value.admin_name,"onUpdate:modelValue":t[5]||(t[5]=l=>o.value.admin_name=l),placeholder:"请选择评估医生",clearable:""},{default:a(()=>[(p(!0),v(b,null,D(U.value,l=>(p(),g(m,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:a(()=>[e(d,{label:"评估时间",prop:"created_at"},{default:a(()=>[e(j,{modelValue:o.value.created_at,"onUpdate:modelValue":t[6]||(t[6]=l=>o.value.created_at=l),type:"date",placeholder:"请选择评估时间",style:{width:"100%"},"value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:a(()=>[e(d,{label:"是否住院",prop:"elder_status"},{default:a(()=>[e(c,{modelValue:o.value.elder_status,"onUpdate:modelValue":t[7]||(t[7]=l=>o.value.elder_status=l),placeholder:"请选择是否住院",clearable:""},{default:a(()=>[e(m,{label:"已入住",value:1}),e(m,{label:"未入住",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,null,{default:a(()=>[ee((p(),g(f,{type:"primary",icon:"Search",onClick:N},{default:a(()=>t[12]||(t[12]=[i("查询")])),_:1,__:[12]})),[[H,["GET.scale/results"]]])]),_:1})]),_:1},8,["model"])]),e(z,{class:"base-info-table",data:R.value,"header-cell-style":L},{default:a(()=>[e(_,{prop:"task",label:"任务名称",align:"center"},{default:a(({row:l})=>[i(V(l.task.name),1)]),_:1}),e(_,{prop:"name",label:"长者姓名",align:"center"},{default:a(({row:l})=>[i(V(l.elder.name),1)]),_:1}),e(_,{prop:"scale",label:"报告类型",align:"center"},{default:a(({row:l})=>[i(V(l.scale.name),1)]),_:1}),e(_,{prop:"scale_set",label:"评估类型",align:"center"},{default:a(({row:l})=>[i(V(l.scale_set.name),1)]),_:1}),e(_,{prop:"created_at",label:"时间",align:"center"}),e(_,{prop:"results",label:"评估结果",align:"center"}),e(_,{prop:"action",label:"操作",align:"center",width:"240"},{default:a(l=>[e(f,{type:"primary",plain:"",size:"default",onClick:I=>T(l.row)},{default:a(()=>t[13]||(t[13]=[i("查看报告")])),_:2,__:[13]},1032,["onClick"]),e(f,{type:"primary",plain:"",size:"default",onClick:t[8]||(t[8]=I=>n.$router.push("/workstation"))},{default:a(()=>t[14]||(t[14]=[i("重新评估")])),_:1,__:[14]})]),_:1})]),_:1},8,["data"]),e(M,{modelValue:k.value,"onUpdate:modelValue":t[9]||(t[9]=l=>k.value=l),title:"评估结果",width:"909"},{footer:a(()=>[Y("div",ae,[e(f,{type:"primary",onClick:$},{default:a(()=>t[15]||(t[15]=[i("打印")])),_:1,__:[15]})])]),default:a(()=>[e(X,{ref_key:"reportRef",ref:w,data:A.value},null,8,["data"])]),_:1},8,["modelValue"]),e(G,{total:P.value,layout:"total, prev, pager, next, jumper",page:o.value.page,"onUpdate:page":t[10]||(t[10]=l=>o.value.page=l),limit:o.value.per_page,"onUpdate:limit":t[11]||(t[11]=l=>o.value.per_page=l),onPagination:y},null,8,["total","page","limit"])],64)}}},ve=Z(te,[["__scopeId","data-v-e053828e"]]);export{ve as default};
