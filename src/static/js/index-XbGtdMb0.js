import{a as Z,p as S,b as ee,c as T,d as ae}from"./epartmene-D2Rd6sgX.js";import{_ as le,d as te,r,e as n,D as h,c as oe,o as v,f as j,h as a,E as y,i as l,A as V,j as i,F as ne}from"./index-gubRP18q.js";const se={class:"search-form"},ue={class:"dialog-footer"},re={__name:"index",setup(de){const{proxy:p}=te(),u=r({keyword:"",status:"",page:1,per_page:10}),k=r(!1),x=r(0),D=r([]),R=()=>({backgroundColor:"#F6F8FF",color:"#C5C5C5"}),c=async()=>{k.value=!0;const s=await Z(u.value);k.value=!1,D.value=s.data.data,x.value=s.data.total};c();const q=()=>{u.value.page=1,c()},B=r(null),o=r({name:"",status:"1"}),O=r({name:[{required:!0,message:"请输入科室名称",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),m=r(!1),w=r(""),E=()=>{o.value.id="",Object.keys(o.value).forEach(s=>{o.value[s]=""}),p.resetForm("formRef")},N=()=>{E(),w.value="新增科室",m.value=!0},H=async s=>{E();const e=await T({id:s.id});m.value=!0,w.value="修改科室",Object.keys(o.value).forEach(_=>{o.value[_]=e.data[_]}),o.value.id=s.id},I=async(s,e)=>{const _=await T({id:e.id});Object.keys(o.value).forEach(d=>{o.value[d]=_.data[d]}),o.value.id=e.id,await S({...o.value,status:s}),p.$modal.msgSuccess("修改成功")},L=()=>{m.value=!1,E()},G=()=>{p.$refs.formRef.validate(async s=>{s&&(o.value.id!=""?(await S(o.value),p.$modal.msgSuccess("修改成功"),m.value=!1,c()):(await ee(o.value),p.$modal.msgSuccess("新增成功"),m.value=!1,c()))})},Q=s=>{p.$modal.confirm("是否确认删除科室?").then(async()=>{await ae({id:s.id}),p.$modal.msgSuccess("删除成功"),c()}).catch(()=>{})};return(s,e)=>{const _=n("el-input"),d=n("el-form-item"),g=n("el-col"),A=n("el-option"),z=n("el-select"),f=n("el-button"),P=n("el-row"),$=n("el-form"),F=n("el-radio"),J=n("el-radio-group"),K=n("Dialog"),U=n("el-table-column"),M=n("el-switch"),W=n("el-table"),X=n("Pagination"),C=h("hasPermi"),Y=h("loading");return v(),oe(ne,null,[j("div",se,[a($,{model:u.value,ref:"queryRef"},{default:l(()=>[a(P,{gutter:30},{default:l(()=>[a(g,{span:8},{default:l(()=>[a(d,{label:"科室名称",prop:"keyword"},{default:l(()=>[a(_,{modelValue:u.value.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value.keyword=t),placeholder:"请输入科室名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),a(g,{span:8},{default:l(()=>[a(d,{label:"状态",prop:"status"},{default:l(()=>[a(z,{modelValue:u.value.status,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value.status=t),placeholder:"请选择状态",clearable:""},{default:l(()=>[a(A,{label:"正常",value:"1"}),a(A,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(g,{span:8},{default:l(()=>[a(d,null,{default:l(()=>[y((v(),V(f,{type:"primary",icon:"Search",onClick:q},{default:l(()=>e[7]||(e[7]=[i("查询")])),_:1,__:[7]})),[[C,["GET.epartmene"]]]),y((v(),V(f,{icon:"plus",type:"primary",onClick:N},{default:l(()=>e[8]||(e[8]=[i("新增科室")])),_:1,__:[8]})),[[C,["POST.epartmene"]]])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),a(K,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=t=>m.value=t),title:w.value,width:"936"},{footer:l(()=>[j("div",ue,[a(f,{onClick:L},{default:l(()=>e[11]||(e[11]=[i("取消")])),_:1,__:[11]}),a(f,{type:"primary",onClick:G},{default:l(()=>e[12]||(e[12]=[i(" 确认 ")])),_:1,__:[12]})])]),default:l(()=>[a($,{model:o.value,rules:O.value,ref_key:"formRef",ref:B,"label-position":"top"},{default:l(()=>[a(P,{gutter:52},{default:l(()=>[a(g,{span:12},{default:l(()=>[a(d,{label:"科室名称",prop:"name"},{default:l(()=>[a(_,{modelValue:o.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.name=t),placeholder:"请输入科室名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(g,{span:12},{default:l(()=>[a(d,{label:"状态",prop:"status"},{default:l(()=>[a(J,{modelValue:o.value.status,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.status=t)},{default:l(()=>[a(F,{value:"1"},{default:l(()=>e[9]||(e[9]=[i("激活")])),_:1,__:[9]}),a(F,{value:"0"},{default:l(()=>e[10]||(e[10]=[i("禁用")])),_:1,__:[10]})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),y((v(),V(W,{class:"base-info-table",data:D.value,"header-cell-style":R},{default:l(()=>[a(U,{prop:"name",label:"名称",align:"center"}),a(U,{prop:"status",label:"状态",align:"center"},{default:l(({row:t})=>[a(M,{modelValue:t.status,"onUpdate:modelValue":b=>t.status=b,"active-value":"1","inactive-value":"0",onChange:b=>I(b,t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(U,{prop:"action",label:"操作",align:"center",width:"160"},{default:l(({row:t})=>[y((v(),V(f,{type:"primary",plain:"",onClick:b=>H(t)},{default:l(()=>e[13]||(e[13]=[i("修改")])),_:2,__:[13]},1032,["onClick"])),[[C,["PATCH.epartmene/{epartmene}"]]]),y((v(),V(f,{type:"danger",plain:"",onClick:b=>Q(t)},{default:l(()=>e[14]||(e[14]=[i("删除")])),_:2,__:[14]},1032,["onClick"])),[[C,["DELETE.epartmene/{epartmene}"]]])]),_:1})]),_:1},8,["data"])),[[Y,k.value]]),a(X,{total:x.value,layout:"total, prev, pager, next, jumper",page:u.value.page,"onUpdate:page":e[5]||(e[5]=t=>u.value.page=t),limit:u.value.per_page,"onUpdate:limit":e[6]||(e[6]=t=>u.value.per_page=t),onPagination:c},null,8,["total","page","limit"])],64)}}},me=le(re,[["__scopeId","data-v-270a79bc"]]);export{me as default};
