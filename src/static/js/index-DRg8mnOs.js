import{_ as ve,d as ge,r as u,m as fe,e as n,D as N,c as y,o as d,f as _,h as a,E as x,i as l,A as b,j as p,F as A,v as T,x as ye,t as O,R as be,C as Ce}from"./index-v815L3Uz.js";import{g as ke,a as he,b as Ve,p as z,c as we,d as I,e as Se}from"./scale-Dym8BGyO.js";const xe={class:"search-form"},Ae={class:"card"},Ue={class:"left hide-scrollbar"},De=["onClick"],Ee={class:"right hide-scrollbar"},$e={class:"right-title"},Pe={class:"dialog-footer"},je=["innerHTML"],Fe={__name:"index",setup(Te){const{proxy:m}=ge(),g=u({page:1,per_page:10}),L=u(0),U=u(!1),R=u([]),K=()=>({backgroundColor:"#F6F8FF",color:"#C5C5C5"}),C=async()=>{U.value=!0;const s=await ke(g.value);U.value=!1,R.value=s.data.data,L.value=s.data.total};C();const M=u(null),o=u({name:"",desc:"",sort:"",status:"",scale_ids:[]}),Q=u({name:[{required:!0,message:"请输入名称",trigger:"blur"}],desc:[{required:!0,message:"请输入描述",trigger:"blur"}]}),v=u(!1),D=u(""),E=()=>{o.value.id="",Object.keys(o.value).forEach(s=>{o.value[s]=""}),o.value.scale_ids=[],o.value.status=1,f.value.category_id=0,f.value.keyword="",m.resetForm("formRef")},h=u([]);(async()=>{const s=await he({all:2});h.value=s.data,h.value.unshift({id:0,name:"全部"})})();const $=u(""),G=(s,e)=>{$.value=s.id,f.value.category_id=s.id,j()},J=fe(()=>{const s=h.value.findIndex(e=>e.id==$.value);return s===-1?{}:{top:`${s*50+46}px`}}),P=u([]),f=u({keyword:"",category_id:"0"}),j=async()=>{const s=await Ve(f.value);P.value=s.data};j();const W=async()=>{await E(),D.value="添加分类",v.value=!0},X=async s=>{E();const e=await I({id:s.id});v.value=!0,D.value="修改分类",Object.keys(o.value).forEach(i=>{o.value[i]=e.data[i]}),o.value.status=Number(e.data.status),o.value.id=s.id},Y=async(s,e)=>{const i=await I({id:e.id});Object.keys(o.value).forEach(c=>{o.value[c]=i.data[c]}),o.value.id=e.id,o.value.scale_ids=i.data.scale_ids.join(","),await z({...o.value,status:s}),m.$modal.msgSuccess("修改成功")},Z=()=>{v.value=!1,E()},ee=()=>{m.$refs.formRef.validate(async s=>{s&&(o.value.id!=""?(await z({...o.value,scale_ids:o.value.scale_ids.join(",")}),m.$modal.msgSuccess("修改成功"),v.value=!1,C()):(await we({...o.value,scale_ids:o.value.scale_ids.join(",")}),m.$modal.msgSuccess("新增成功"),v.value=!1,C()))})},ae=s=>{m.$modal.confirm("是否确认删除?").then(async()=>{await Se({id:s.id}),m.$modal.msgSuccess("删除成功"),C()}).catch(()=>{})};return(s,e)=>{const i=n("el-button"),c=n("el-form-item"),q=n("el-form"),B=n("el-input"),V=n("el-col"),w=n("el-row"),le=n("Editor"),te=n("el-tooltip"),oe=n("el-checkbox"),se=n("el-checkbox-group"),ne=n("el-divider"),ue=n("el-empty"),H=n("el-radio"),de=n("el-radio-group"),ie=n("Dialog"),S=n("el-table-column"),re=n("el-switch"),ce=n("el-table"),_e=n("Pagination"),F=N("hasPermi"),pe=N("loading");return d(),y(A,null,[_("div",xe,[a(q,{model:g.value,ref:"queryRef","label-position":"top"},{default:l(()=>[a(c,null,{default:l(()=>[x((d(),b(i,{icon:"plus",type:"primary",onClick:W},{default:l(()=>e[8]||(e[8]=[p("添加分类")])),_:1,__:[8]})),[[F,["POST.scale_category"]]])]),_:1})]),_:1},8,["model"])]),a(ie,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=t=>v.value=t),title:D.value,width:"1205"},{footer:l(()=>[_("div",Pe,[a(i,{onClick:Z},{default:l(()=>e[11]||(e[11]=[p("取消")])),_:1,__:[11]}),a(i,{type:"primary",onClick:ee},{default:l(()=>e[12]||(e[12]=[p(" 确认 ")])),_:1,__:[12]})])]),default:l(()=>[a(q,{model:o.value,rules:Q.value,ref_key:"formRef",ref:M,"label-position":"top"},{default:l(()=>[a(w,null,{default:l(()=>[a(V,{span:24},{default:l(()=>[a(c,{label:"分类名称",prop:"name"},{default:l(()=>[a(B,{modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.name=t),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(w,null,{default:l(()=>[a(V,{span:24},{default:l(()=>[a(c,{label:"分类介绍",prop:"desc"},{default:l(()=>[a(le,{modelValue:o.value.desc,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.desc=t),height:150},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(w,null,{default:l(()=>[a(V,{span:24},{default:l(()=>[a(c,{label:"量表设置","label-width":"100"},{default:l(()=>[_("div",Ae,[_("div",Ue,[(d(!0),y(A,null,T(h.value,(t,r)=>(d(),y("div",{class:ye(["item",{"active-item":$.value===t.id}]),key:r,onClick:k=>G(t,r)},[a(te,{effect:"dark",content:t.name,placement:"right"},{default:l(()=>[p(O(t.name),1)]),_:2},1032,["content"])],10,De))),128)),_("div",{class:"active-indicator",style:be(J.value)},null,4)]),_("div",Ee,[a(B,{modelValue:f.value.keyword,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value.keyword=t),class:"search",placeholder:"支持缩写、中文名称、关键词等搜索","suffix-icon":"search",onKeydown:Ce(j,["enter"])},null,8,["modelValue"]),P.value.length>0?(d(!0),y(A,{key:0},T(P.value,(t,r)=>(d(),y("div",{key:r},[_("div",$e,O(t.name),1),a(se,{modelValue:o.value.scale_ids,"onUpdate:modelValue":e[3]||(e[3]=k=>o.value.scale_ids=k)},{default:l(()=>[(d(!0),y(A,null,T(t.scale,(k,me)=>(d(),b(oe,{key:me,label:k.name,value:k.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue"]),a(ne)]))),128)):(d(),b(ue,{key:1,description:"暂无数据","image-size":150}))])])]),_:1})]),_:1})]),_:1}),a(w,null,{default:l(()=>[a(V,{span:24},{default:l(()=>[a(c,{label:"是否开启",prop:"status"},{default:l(()=>[a(de,{modelValue:o.value.status,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.status=t)},{default:l(()=>[a(H,{value:1},{default:l(()=>e[9]||(e[9]=[p("是")])),_:1,__:[9]}),a(H,{value:0},{default:l(()=>e[10]||(e[10]=[p("否")])),_:1,__:[10]})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),x((d(),b(ce,{class:"base-info-table",data:R.value,"header-cell-style":K},{default:l(()=>[a(S,{prop:"name",label:"分类名称",align:"center"}),a(S,{prop:"desc",label:"分类介绍",align:"center","show-overflow-tooltip":""},{default:l(({row:t})=>[_("div",{innerHTML:t.desc},null,8,je)]),_:1}),a(S,{prop:"status",label:"是否开启",align:"center"},{default:l(({row:t})=>[a(re,{modelValue:t.status,"onUpdate:modelValue":r=>t.status=r,"active-value":1,"inactive-value":0,onChange:r=>Y(r,t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(S,{prop:"action",label:"操作",align:"center",width:"240"},{default:l(({row:t})=>[x((d(),b(i,{type:"primary",plain:"",onClick:r=>X(t)},{default:l(()=>e[13]||(e[13]=[p("编辑")])),_:2,__:[13]},1032,["onClick"])),[[F,["PATCH.scale_category/{scale_category}"]]]),x((d(),b(i,{type:"danger",plain:"",onClick:r=>ae(t)},{default:l(()=>e[14]||(e[14]=[p("删除")])),_:2,__:[14]},1032,["onClick"])),[[F,["DELETE.scale_category/{scale_category}"]]])]),_:1})]),_:1},8,["data"])),[[pe,U.value]]),a(_e,{total:L.value,layout:"total, prev, pager, next, jumper",page:g.value.page,"onUpdate:page":e[6]||(e[6]=t=>g.value.page=t),limit:g.value.per_page,"onUpdate:limit":e[7]||(e[7]=t=>g.value.per_page=t),onPagination:C},null,8,["total","page","limit"])],64)}}},Be=ve(Fe,[["__scopeId","data-v-c2a158a7"]]);export{Be as default};
