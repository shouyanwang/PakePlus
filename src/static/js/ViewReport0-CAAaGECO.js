import{_ as W,a as j,b as z,c as M}from"./dashboard_4-C_LFPXOZ.js";import{E as O,h as U}from"./jspdf.es.min-RV261WyM.js";import{a as $}from"./index-B8B4HmUB.js";import{_ as J,d as Q,r as P,w as Y,e as p,A as I,o as d,i as _,f as t,t as l,p as o,h as i,j as u,c as m,F as q,v as K,B as v,O as X,Q as Z}from"./index-v815L3Uz.js";const tt={class:"report-view-title"},et={class:"user-wrap"},st={class:"username"},ot={class:"text"},lt={class:"info-wrap"},it={class:"info-item"},at={class:"value"},nt={class:"info-item"},rt={class:"value"},dt={class:"info-item"},ct={class:"value"},_t={class:"info-item"},pt={class:"value"},ut={class:"doctor-wrap"},mt={class:"doctor-title"},gt={class:"doctor-info"},vt={class:"black"},ft={class:"doctor-title"},ht={class:"desc-dot"},bt={class:"doctor-title"},wt={class:"desc-dot"},yt={class:"doctor-title"},kt={class:"assess-result"},xt={class:"doctor-title"},Vt={class:"desc-dot"},Ct={class:"triangle-desc"},Ft={class:"triangle-desc"},Dt={class:"triangle-desc"},Pt={class:"triangle-desc"},Rt={class:"triangle-desc"},Bt={class:"triangle-desc"},Et={class:"triangle-desc"},It={class:"triangle-desc"},Nt={class:"triangle-desc"},Tt={class:"status-wrap"},At={key:0,class:"status-img",src:W,alt:""},Ht={key:1,class:"status-img",src:j,alt:""},Lt={key:2,class:"status-img",src:z,alt:""},St={key:3,class:"status-img",src:M,alt:""},Gt={class:"status-text"},Wt={key:0},jt={key:1},zt={key:2},Mt={key:3},Ot={key:4},Ut={class:"dialog-footer"},$t={__name:"ViewReport0",props:{modelValue:{type:Boolean,default:!1},id:{type:Number,default:""}},emits:["update:modelValue"],setup(N,{expose:T,emit:A}){const{proxy:R}=Q(),V=N,H=A,y=P(V.modelValue),s=P({}),L=async()=>{const g=await $({id:V.id});s.value=g.data};Y(()=>V.modelValue,async g=>{g==!0&&(R.$modal.loading("加载中..."),await L(),R.$modal.closeLoading()),y.value=g});const S=()=>{H("update:modelValue",!1)},G={"-1":"老人能力等级划分",0:"综合评估报告",30:"老年护理需求等级评定",29:"老年综合评估（CGA）",31:"老年康复综合评估（RCGA）"},B=P(null),E=async()=>{const g=Z.service({lock:!0,text:"正在生成PDF，请稍候..."}),e=B.value,a=new O({orientation:"p",unit:"mm",format:"a4"}),k=a.internal.pageSize.getHeight(),C=a.internal.pageSize.getWidth(),f=15,w=k-2*f,n=await U(e,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#FFFFFF",scrollY:0}),r=C-2*f,F=n.height*r/n.width,D=Math.ceil(F/w);for(let h=0;h<D;h++){h>0&&a.addPage();const c=h*w*(n.width/r),b=Math.min(w*(n.width/r),n.height-c),x=document.createElement("canvas");x.width=n.width,x.height=b,x.getContext("2d").drawImage(n,0,c,n.width,b,0,0,n.width,b),a.addImage(x.toDataURL("image/jpeg",.95),"JPEG",f,f,r,b*(r/n.width))}window.open(a.output("bloburl")),g.close()};return T({generatePDF:E}),(g,e)=>{const a=p("svg-icon"),k=p("el-button"),C=p("el-form-item"),f=p("el-col"),w=p("el-row"),n=p("el-form"),r=p("el-table-column"),F=p("el-table"),D=p("el-divider"),h=p("Dialog");return d(),I(h,{modelValue:o(y),"onUpdate:modelValue":e[0]||(e[0]=c=>X(y)?y.value=c:null),width:"1205",title:"查看报告",onClose:S},{footer:_(()=>[t("div",Ut,[i(k,{type:"primary",onClick:E},{default:_(()=>e[19]||(e[19]=[u("打印报告")])),_:1,__:[19]})])]),default:_(()=>[t("div",{ref_key:"elementToPrint",ref:B,class:"report-view"},[t("div",tt,l(G[o(s).type]),1),t("div",et,[t("div",st,[t("div",ot,[i(a,{"icon-class":"user-2",class:"svg-icon"}),u(" "+l(o(s).elder.name),1)]),i(k,{type:"primary",round:""},{default:_(()=>[u(l(g.statusFormat(o(s).elder.status)),1)]),_:1})]),t("div",lt,[t("div",it,[e[1]||(e[1]=t("div",{class:"label"},"年龄",-1)),t("div",at,l(o(s).elder.age),1)]),t("div",nt,[e[2]||(e[2]=t("div",{class:"label"},"性别",-1)),t("div",rt,l(g.genderFormat(o(s).elder.sex)),1)]),t("div",dt,[e[3]||(e[3]=t("div",{class:"label"},"科别",-1)),t("div",ct,l(o(s).elder.epartmene.name),1)]),t("div",_t,[e[4]||(e[4]=t("div",{class:"label"},"床位号",-1)),t("div",pt,l(o(s).elder.building.name)+"/"+l(o(s).elder.room.name)+"/"+l(o(s).elder.bed.name),1)])])]),t("div",ut,[t("div",mt,[i(a,{"icon-class":"doctor",class:"svg-icon"}),e[5]||(e[5]=u(" 医药师 "))]),t("div",gt,[i(n,{"label-width":"120"},{default:_(()=>[i(w,null,{default:_(()=>[(d(!0),m(q,null,K(o(s).participant,(c,b)=>(d(),I(f,{key:b,span:6},{default:_(()=>[i(C,{label:c.role},{default:_(()=>[t("div",vt,l(c.user),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})]),t("div",ft,[i(a,{"icon-class":"case",class:"svg-icon"}),e[6]||(e[6]=u(" 病例概况 "))]),t("div",ht,l(o(s).report0.case_overview),1),t("div",bt,[i(a,{"icon-class":"bar",class:"svg-icon"}),e[7]||(e[7]=u(" 目前诊断 "))]),t("div",wt,l(o(s).report0.current_diagnosis),1),t("div",yt,[i(a,{"icon-class":"star",class:"svg-icon"}),e[8]||(e[8]=u(" 评估量表得分 "))]),i(F,{data:o(s).report0.scale_result,border:""},{default:_(()=>[i(r,{type:"index",label:"序号",align:"center"}),i(r,{prop:"name",label:"量表名称",align:"center"},{default:_(c=>[u(l(c.row.scale.name),1)]),_:1}),i(r,{prop:"score",label:"得分",align:"center"}),i(r,{prop:"name",label:"评估类型",align:"center"},{default:_(c=>[u(l(c.row.scale_set.name),1)]),_:1}),i(r,{prop:"created_at",label:"评估时间",align:"center"}),i(r,{prop:"results",label:"结果",align:"center"})]),_:1},8,["data"]),t("div",kt," 评估结果 "+l(o(s).report0.final_result),1),t("div",xt,[i(a,{"icon-class":"bar",class:"svg-icon"}),e[9]||(e[9]=u(" 会诊目的 "))]),t("div",Vt,l(o(s).report0.purpose),1),i(D),e[10]||(e[10]=t("div",{class:"triangle-title"},"药物指导",-1)),t("div",Ct,l(o(s).report0.med_guid),1),e[11]||(e[11]=t("div",{class:"triangle-title"},"中医证治",-1)),t("div",Ft,l(o(s).report0.tcm_sdt),1),e[12]||(e[12]=t("div",{class:"triangle-title"},"医疗护理",-1)),t("div",Dt,l(o(s).report0.med_care),1),e[13]||(e[13]=t("div",{class:"triangle-title"},"康复治疗",-1)),t("div",Pt,l(o(s).report0.rehab_ther),1),e[14]||(e[14]=t("div",{class:"triangle-title"},"营养膳食",-1)),t("div",Rt,l(o(s).report0.nutri_diet),1),e[15]||(e[15]=t("div",{class:"triangle-title"},"心理指导",-1)),t("div",Bt,l(o(s).report0.psy_couns),1),e[16]||(e[16]=t("div",{class:"triangle-title"},"运动处方",-1)),t("div",Et,l(o(s).report0.ex_pres),1),e[17]||(e[17]=t("div",{class:"triangle-title"},"生活照顾",-1)),t("div",It,l(o(s).report0.daily_care),1),e[18]||(e[18]=t("div",{class:"triangle-title"},"专家意见",-1)),t("div",Nt,l(o(s).report0.exo),1),t("div",Tt,[o(s).report0.final_result==0||o(s).report0.final_result==1?(d(),m("img",At)):v("",!0),o(s).report0.final_result==2?(d(),m("img",Ht)):v("",!0),o(s).report0.final_result==3?(d(),m("img",Lt)):v("",!0),o(s).report0.final_result==4?(d(),m("img",St)):v("",!0),t("div",Gt,[o(s).report0.final_result==0?(d(),m("span",Wt,"0级能力完好")):v("",!0),o(s).report0.final_result==1?(d(),m("span",jt,"1级轻度失能")):v("",!0),o(s).report0.final_result==2?(d(),m("span",zt,"2级中度失能")):v("",!0),o(s).report0.final_result==3?(d(),m("span",Mt,"3级重度失能")):v("",!0),o(s).report0.final_result==4?(d(),m("span",Ot,"4级完全失能")):v("",!0)])])])],512)]),_:1},8,["modelValue"])}}},Xt=J($t,[["__scopeId","data-v-adff3e4c"]]);export{Xt as default};
