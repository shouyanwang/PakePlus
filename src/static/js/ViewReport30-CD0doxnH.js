import{_ as z,a as M,b as U,c as $}from"./dashboard_4-C_LFPXOZ.js";import{E as J,h as O}from"./jspdf.es.min-DaAeb2LW.js";import{a as Q}from"./index-CY7xaJsh.js";import{_ as Y,d as q,r as R,w as K,e as g,A as I,o,i as p,f as s,t as r,p as l,h as a,j as m,c as i,F as N,v as T,B as d,Q as X,R as Z}from"./index-BCPe6f7k.js";const ss={class:"report-view-title"},es={class:"user-wrap"},ts={class:"username"},ls={class:"text"},os={class:"info-wrap"},as={class:"info-item"},is={class:"value"},ns={class:"info-item"},rs={class:"value"},ds={class:"info-item"},cs={class:"value"},_s={class:"info-item"},us={class:"value"},ps={class:"doctor-wrap"},ms={class:"doctor-title"},vs={class:"doctor-info"},gs={class:"black"},fs={class:"doctor-title"},hs={class:"dot-result"},bs={class:"value"},ys={key:0},ws={key:1},ks={key:2},xs={key:3},Vs={key:4},Cs={class:"dot-result"},Fs={class:"value"},Ds={class:"doctor-title"},Rs={class:"doctor-title"},Ps={class:"warn-wrap"},Bs={class:"doctor-title"},Es={class:"status-wrap"},Is={key:0,class:"status-img",src:z,alt:""},Ns={key:1,class:"status-img",src:M,alt:""},Ts={key:2,class:"status-img",src:U,alt:""},As={key:3,class:"status-img",src:$,alt:""},Hs={class:"status-text"},Ls={key:0},Ss={key:1},Gs={key:2},Ws={key:3},js={key:4},zs={class:"dialog-footer"},Ms={__name:"ViewReport30",props:{modelValue:{type:Boolean,default:!1},id:{type:Number,default:""}},emits:["update:modelValue"],setup(A,{expose:H,emit:L}){const{proxy:P}=q(),V=A,S=L,y=R(V.modelValue),t=R({}),G=async()=>{const v=await Q({id:V.id});t.value=v.data};K(()=>V.modelValue,async v=>{v==!0&&(P.$modal.loading("加载中..."),await G(),P.$modal.closeLoading()),y.value=v});const W=()=>{S("update:modelValue",!1)},j={"-1":"老人能力等级划分",0:"综合评估报告",30:"老年护理需求等级评定",29:"老年综合评估（CGA）",31:"老年康复综合评估（RCGA）"},B=R(null),E=async()=>{const v=Z.service({lock:!0,text:"正在生成PDF，请稍候..."}),e=B.value,c=new J({orientation:"p",unit:"mm",format:"a4"}),w=c.internal.pageSize.getHeight(),C=c.internal.pageSize.getWidth(),f=15,b=w-2*f,_=await O(e,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#FFFFFF",scrollY:0}),u=C-2*f,F=_.height*u/_.width,D=Math.ceil(F/b);for(let n=0;n<D;n++){n>0&&c.addPage();const h=n*b*(_.width/u),k=Math.min(b*(_.width/u),_.height-h),x=document.createElement("canvas");x.width=_.width,x.height=k,x.getContext("2d").drawImage(_,0,h,_.width,k,0,0,_.width,k),c.addImage(x.toDataURL("image/jpeg",.95),"JPEG",f,f,u,k*(u/_.width))}window.open(c.output("bloburl")),v.close()};return H({generatePDF:E}),(v,e)=>{const c=g("svg-icon"),w=g("el-button"),C=g("el-form-item"),f=g("el-col"),b=g("el-row"),_=g("el-form"),u=g("el-table-column"),F=g("el-table"),D=g("Dialog");return o(),I(D,{modelValue:l(y),"onUpdate:modelValue":e[0]||(e[0]=n=>X(y)?y.value=n:null),width:"1205",title:"查看报告",onClose:W},{footer:p(()=>[s("div",zs,[a(w,{type:"primary",onClick:E},{default:p(()=>e[14]||(e[14]=[m("打印报告")])),_:1,__:[14]})])]),default:p(()=>[s("div",{ref_key:"elementToPrint",ref:B,class:"report-view"},[s("div",ss,r(j[l(t).type]),1),s("div",es,[s("div",ts,[s("div",ls,[a(c,{"icon-class":"user-2",class:"svg-icon"}),m(" "+r(l(t).elder.name),1)]),a(w,{type:"primary",round:""},{default:p(()=>[m(r(v.statusFormat(l(t).elder.status)),1)]),_:1})]),s("div",os,[s("div",as,[e[1]||(e[1]=s("div",{class:"label"},"年龄",-1)),s("div",is,r(l(t).elder.age),1)]),s("div",ns,[e[2]||(e[2]=s("div",{class:"label"},"性别",-1)),s("div",rs,r(v.genderFormat(l(t).elder.sex)),1)]),s("div",ds,[e[3]||(e[3]=s("div",{class:"label"},"科别",-1)),s("div",cs,r(l(t).elder.epartmene.name),1)]),s("div",_s,[e[4]||(e[4]=s("div",{class:"label"},"床位号",-1)),s("div",us,r(l(t).elder.building.name)+"/"+r(l(t).elder.room.name)+"/"+r(l(t).elder.bed.name),1)])])]),s("div",ps,[s("div",ms,[a(c,{"icon-class":"doctor",class:"svg-icon"}),e[5]||(e[5]=m(" 医药师 "))]),s("div",vs,[a(_,{"label-width":"120"},{default:p(()=>[a(b,null,{default:p(()=>[(o(!0),i(N,null,T(l(t).participant,(n,h)=>(o(),I(f,{key:h,span:6},{default:p(()=>[a(C,{label:n.role},{default:p(()=>[s("div",gs,r(n.user),1)]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1})]),s("div",fs,[a(c,{"icon-class":"star",class:"svg-icon"}),e[6]||(e[6]=m(" 评估量表得分 "))]),a(F,{data:l(t).report30.scale_result,border:""},{default:p(()=>[a(u,{type:"index",label:"序号",align:"center"}),a(u,{prop:"name",label:"量表名称",align:"center"},{default:p(n=>[m(r(n.row.scale.name),1)]),_:1}),a(u,{prop:"score",label:"得分",align:"center"}),a(u,{prop:"name",label:"评估类型",align:"center"},{default:p(n=>[m(r(n.row.scale_set.name),1)]),_:1}),a(u,{prop:"created_at",label:"评估时间",align:"center"}),a(u,{prop:"results",label:"结果",align:"center"})]),_:1},8,["data"]),s("div",hs,[e[7]||(e[7]=s("div",{class:"label"},"评估能力等级",-1)),s("div",bs,[l(t).report30.capability_level==0?(o(),i("span",ys,"0级能力完好")):d("",!0),l(t).report30.capability_level==1?(o(),i("span",ws,"1级轻度失能")):d("",!0),l(t).report30.capability_level==2?(o(),i("span",ks,"2级中度失能")):d("",!0),l(t).report30.capability_level==3?(o(),i("span",xs,"3级重度失能")):d("",!0),l(t).report30.capability_level==4?(o(),i("span",Vs,"4级完全失能")):d("",!0)])]),s("div",Cs,[e[8]||(e[8]=s("div",{class:"label"},"评估类型",-1)),s("div",Fs,r(l(t).scale_set.name),1)]),s("div",Ds,[s("div",null,[a(c,{"icon-class":"plus",class:"svg-icon"}),e[9]||(e[9]=m(" 老年综合症罹患项 "))])]),(o(!0),i(N,null,T(l(t).report30.syndrome_text,(n,h)=>(o(),i("div",{key:h,class:"dot-value"},r(n.value),1))),128)),s("div",Rs,[s("div",null,[a(c,{"icon-class":"medal",class:"svg-icon"}),e[10]||(e[10]=m(" 护理需求等级评定依据 "))])]),e[13]||(e[13]=s("div",{class:"assess-list"},[s("div",{class:"assess-item"},[s("div",{class:"label"},"评估能力等级： "),s("div",{class:"result success"},[s("div",{class:"dot success"}),s("span",null,"能力完好")]),s("div",{class:"value"}," 老年综合征罹患项数：1-2项  护理需求等级为0级(能力完好)，3-5项  护理需求等级为1级(轻度失能) ")]),s("div",{class:"assess-item"},[s("div",{class:"label"},"评估能力等级： "),s("div",{class:"result warning"},[s("div",{class:"dot warning"}),s("span",null,"轻度受损")]),s("div",{class:"value"}," 老年综合征罹患项数：1-2项  护理需求等级为0级(能力完好)，3-5项  护理需求等级为1级(轻度失能) ")]),s("div",{class:"assess-item"},[s("div",{class:"label"},"评估能力等级： "),s("div",{class:"result danger"},[s("div",{class:"dot danger"}),s("span",null,"中度受损")]),s("div",{class:"value"}," 老年综合征罹患项数：1-2项  护理需求等级为0级(能力完好)，3-5项  护理需求等级为1级(轻度失能) ")]),s("div",{class:"assess-item"},[s("div",{class:"label"},"评估能力等级： "),s("div",{class:"result danger-2"},[s("div",{class:"dot danger-2"}),s("span",null,"重度受损")]),s("div",{class:"value"}," 老年综合征罹患项数：1-2项  护理需求等级为0级(能力完好)，3-5项  护理需求等级为1级(轻度失能) ")])],-1)),s("div",Ps,[a(c,{"icon-class":"warn",class:"svg-icon"}),e[11]||(e[11]=m(" 老年综合征罹患项数：5项以上 护理需求等级为4级(完全失能) "))]),s("div",Bs,[s("div",null,[a(c,{"icon-class":"triangle",class:"svg-icon"}),e[12]||(e[12]=m(" 护理需求等级 "))])]),s("div",Es,[l(t).report30.final_result==0||l(t).report30.final_result==1?(o(),i("img",Is)):d("",!0),l(t).report30.final_result==2?(o(),i("img",Ns)):d("",!0),l(t).report30.final_result==3?(o(),i("img",Ts)):d("",!0),l(t).report30.final_result==4?(o(),i("img",As)):d("",!0),s("div",Hs,[l(t).report30.final_result==0?(o(),i("span",Ls,"0级能力完好")):d("",!0),l(t).report30.final_result==1?(o(),i("span",Ss,"1级轻度失能")):d("",!0),l(t).report30.final_result==2?(o(),i("span",Gs,"2级中度失能")):d("",!0),l(t).report30.final_result==3?(o(),i("span",Ws,"3级重度失能")):d("",!0),l(t).report30.final_result==4?(o(),i("span",js,"4级完全失能")):d("",!0)])])])],512)]),_:1},8,["modelValue"])}}},Ys=Y(Ms,[["__scopeId","data-v-038f3558"]]);export{Ys as default};
