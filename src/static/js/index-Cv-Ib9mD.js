import{p as z,b as Q,c as G}from"./index-CbSnCnmH.js";import{g as H}from"./scaleSet-CH4yhRsR.js";import{u as J}from"./workstation-vbz7OxU-.js";import{_ as K,d as M,u as O,a as X,r as u,w as Y,e as y,c as a,o as s,f as l,h as m,B as Z,p as i,F as _,v,x as ee,t as r,i as d,Q as T,A as N,j as S}from"./index-BCPe6f7k.js";import{u as te}from"./elder-DaZm3efB.js";const se={class:"project-wrap hide-scrollbar"},oe={key:0,class:"tag-wrap"},ae=["onClick"],le={class:"assessment-content hide-scrollbar"},ne={class:"project-title"},ie={class:"project-type hide-scrollbar"},re={class:"l"},de={class:"v"},ce={class:"project-action"},ue=["onClick"],_e={key:1,style:{width:"100%"}},pe={class:"assessment-type"},me={class:"form-item-title"},ve={style:{width:"800px"}},fe={class:"dialog-footer"},ge={__name:"index",setup(ye){const{proxy:k}=M(),h=J(),j=O();X();const b=te(),w=u([]),x=async()=>{var e;const o=await Q({id:j.query.id,tags_key:(e=h.tags[V.value])==null?void 0:e.key,page:1,per_page:1e3});w.value=o.data.data},V=u(0),U=(o,e)=>{V.value=e,x()};Y(()=>j.query,o=>{o.id&&x()},{immediate:!0});const p=u(!1),f=u(""),g=u({}),C=u(""),A=u([]),D=async()=>{const o=await H();A.value=o.data},P=async()=>{const o=await G({id:C.value,elder_id:b.elder.id});g.value=o.data},R=async o=>{C.value=o.id,await D(),await P(),p.value=!0},q=()=>{p.value=!1},E=async()=>{if(!f.value){k.$modal.msgWarning("请选择评估类型");return}for(const e of g.value.topic_list)if(!e.radio){k.$modal.msgWarning(`请回答问题${e.topic}`);return}const o=g.value.topic_list.map(e=>({topic_id:e.id,option_id:e.radio}));await z({elder_id:b.elder.id,scale_id:C.value,scale_set_id:f.value,answers:o}),k.$modal.msgSuccess("提交成功"),p.value=!1};return(o,e)=>{var I;const F=y("el-empty"),W=y("el-radio"),$=y("el-radio-group"),B=y("el-button"),L=y("Dialog");return s(),a(_,null,[l("div",se,[i(h).tags.length>0?(s(),a("div",oe,[(s(!0),a(_,null,v(i(h).tags,(t,n)=>(s(),a("div",{class:ee(["tag-item",{active:i(V)==n}]),key:n,onClick:c=>U(t,n)},r(t.value),11,ae))),128))])):Z("",!0),l("div",le,[i(w).length>0?(s(!0),a(_,{key:0},v(i(w),t=>(s(),a("div",{class:"project-item",key:t.id},[l("div",ne,r(t.name),1),l("div",ie,[(s(!0),a(_,null,v(t.use_count,n=>(s(),a("div",{key:n.id,class:"project-type-item"},[l("div",re,r(n.name),1),l("div",de,r(n.count)+"次",1)]))),128))]),l("div",ce,[l("div",{class:"btn-2",onClick:n=>R(t)},"开始评估",8,ue)])]))),128)):(s(),a("div",_e,[m(F)]))])]),m(L,{modelValue:i(p),"onUpdate:modelValue":e[1]||(e[1]=t=>T(p)?p.value=t:null),title:(I=i(g).scale)==null?void 0:I.name,width:"909"},{footer:d(()=>[l("div",fe,[m(B,{onClick:q},{default:d(()=>e[3]||(e[3]=[S("取消")])),_:1,__:[3]}),m(B,{type:"primary",onClick:E},{default:d(()=>e[4]||(e[4]=[S(" 确认 ")])),_:1,__:[4]})])]),default:d(()=>[l("div",pe,[m($,{modelValue:i(f),"onUpdate:modelValue":e[0]||(e[0]=t=>T(f)?f.value=t:null)},{default:d(()=>[(s(!0),a(_,null,v(i(A),(t,n)=>(s(),N(W,{key:n,value:t.id},{default:d(()=>[S(r(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),(s(!0),a(_,null,v(i(g).topic_list,(t,n)=>(s(),a("div",{key:t.id,class:"form-item"},[l("div",me,r(n+1)+"、"+r(t.topic),1),e[2]||(e[2]=l("div",{class:"form-item-desc"},null,-1)),m($,{modelValue:t.radio,"onUpdate:modelValue":c=>t.radio=c},{default:d(()=>[(s(!0),a(_,null,v(t.options,c=>(s(),N(W,{key:c.id,value:c.id},{default:d(()=>[l("div",ve,r(c.no)+"."+r(c.option),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128))]),_:1},8,["modelValue","title"])],64)}}},Se=K(ge,[["__scopeId","data-v-a2513492"]]);export{Se as default};
