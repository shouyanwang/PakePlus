import{E as W,h as z}from"./jspdf.es.min-uZZ0fheg.js";import{L as T,E as C}from"./index-PIvSEPGS.js";import{_ as D,r as _,e as E,c as d,o as c,f as t,h,j as H,t as n,i as A,F,v as S,Q as B}from"./index-gubRP18q.js";const I={class:"wrap"},O={class:"user-wrap"},R={class:"username"},N={class:"text"},V={class:"info-wrap"},G={class:"info-item"},J={class:"value"},Q={class:"info-item"},U={class:"value"},Y={class:"info-item"},q={class:"value"},K={class:"info-item"},X={class:"value"},Z={class:"wrap"},$={class:"cate"},tt={class:"radar-wrap"},et={class:"desc-wrap"},st={class:"wrap"},at={class:"wrap"},ot={class:"sub-title"},it=["innerHTML"],nt=["innerHTML"],lt={class:"wrap"},rt={class:"sub-title"},dt=["innerHTML"],ct={__name:"Result",props:{data:{type:Object,default:()=>{}}},setup(o,{expose:M}){const f=o,k=_({grid:{bottom:"10%",top:"10%",left:"10%",right:"10%"},xAxis:{type:"category",data:f.data.result.score_json.map(a=>a.category),axisLabel:{interval:0}},yAxis:{type:"value",interval:10},series:[{data:f.data.result.score_json.map(a=>a.conversion_score),type:"bar",itemStyle:{borderRadius:[10,10,0,0],color:new T(0,0,0,1,[{offset:0,color:"#BFCEFF"},{offset:1,color:"#5276EF"}])},barWidth:"40%"}]}),P=_({radar:{indicator:[{name:"平和质",max:100},{name:"特禀质",max:100},{name:"气郁质",max:100},{name:"湿热质",max:100},{name:"痰湿质",max:100},{name:"血瘀质",max:100},{name:"阴虚质",max:100},{name:"阳虚质",max:100},{name:"气虚质",max:100}]},series:[{name:"体质类型解读",type:"radar",data:[{value:f.data.result.score_json.map(a=>a.conversion_score),areaStyle:{color:new T(0,0,0,1,[{offset:0,color:"rgba(99, 132, 241, 0.8)"},{offset:1,color:"rgba(99, 132, 241, 0.2)"}])},lineStyle:{width:2,color:"#6384F1"},symbol:"circle",symbolSize:0,itemStyle:{color:"#6384F1"}}]}]}),j=_({grid:{top:20,right:50,bottom:20,left:0},xAxis:{show:!1},yAxis:{show:!1},series:[{type:"scatter",symbolSize:function(a){return 15+a[2]*2},data:f.data.result.score_json.map((a,e)=>{const l=["#5276EF","#97C2FF","#7D9BFF"],g=l[Math.floor(Math.random()*l.length)],u=[{x:15,y:80},{x:35,y:20},{x:30,y:60},{x:20,y:40},{x:20,y:70},{x:15,y:50},{x:30,y:30},{x:30,y:90},{x:10,y:10}];return{value:[u[e].x,u[e].y,a.conversion_score],name:a.category,itemStyle:{color:g,opacity:.8,borderColor:"#fff",borderWidth:2}}}),itemStyle:{opacity:.8,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:"{b}",color:"#fff",fontWeight:"normal",fontSize:18,position:"inside"},emphasis:{scale:!0,scaleSize:5}}]}),L=_(null);return M({generatePDF:async()=>{const a=B.service({lock:!0,text:"正在生成PDF，请稍候..."}),e=L.value,l=new W({orientation:"p",unit:"mm",format:"a4"}),g=l.internal.pageSize.getHeight(),u=l.internal.pageSize.getWidth(),v=15,p=g-2*v,i=await z(e,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#FFFFFF",scrollY:0}),m=u-2*v,x=i.height*m/i.width,y=Math.ceil(x/p);for(let s=0;s<y;s++){s>0&&l.addPage();const r=s*p*(i.width/m),b=Math.min(p*(i.width/m),i.height-r),w=document.createElement("canvas");w.width=i.width,w.height=b,w.getContext("2d").drawImage(i,0,r,i.width,b,0,0,i.width,b),l.addImage(w.toDataURL("image/jpeg",.95),"JPEG",v,v,m,b*(m/i.width))}window.open(l.output("bloburl")),a.close()}}),(a,e)=>{var u,v,p,i,m,x,y;const l=E("svg-icon"),g=E("el-button");return c(),d("div",{ref_key:"elementToPrint",ref:L,class:"pageCon"},[e[12]||(e[12]=t("h1",{class:"pageTitle"},"中医体质辨识报告",-1)),t("div",I,[e[4]||(e[4]=t("div",{class:"title"},"长者信息",-1)),t("div",O,[t("div",R,[t("div",N,[h(l,{"icon-class":"user-2",class:"svg-icon"}),H(" "+n((u=o.data.elder)==null?void 0:u.name),1)]),h(g,{type:"primary",round:""},{default:A(()=>[H(n(a.statusFormat(o.data.elder.status)),1)]),_:1})]),t("div",V,[t("div",G,[e[0]||(e[0]=t("div",{class:"label"},"年龄",-1)),t("div",J,n((v=o.data.elder)==null?void 0:v.age),1)]),t("div",Q,[e[1]||(e[1]=t("div",{class:"label"},"性别",-1)),t("div",U,n(a.genderFormat((p=o.data.elder)==null?void 0:p.sex)),1)]),t("div",Y,[e[2]||(e[2]=t("div",{class:"label"},"科别",-1)),t("div",q,n((i=o.data.elder.epartmene)==null?void 0:i.name),1)]),t("div",K,[e[3]||(e[3]=t("div",{class:"label"},"床位号",-1)),t("div",X,n((m=o.data.elder)==null?void 0:m.building.name)+"/"+n((x=o.data.elder)==null?void 0:x.room.name)+"/"+n((y=o.data.elder)==null?void 0:y.bed.name),1)])])])]),t("div",Z,[e[6]||(e[6]=t("div",{class:"title"},"辨识信息",-1)),e[7]||(e[7]=t("div",{class:"sub-title"},"体质类型转化分",-1)),h(C,{options:k.value,width:"900px",height:"400px"},null,8,["options"]),t("div",$,[(c(!0),d(F,null,S(o.data.result.score_json,(s,r)=>(c(),d("div",{key:r,class:"item"},n(s.category)+"    "+n(s.conversion_score)+"分 ",1))),128))]),e[8]||(e[8]=t("div",{class:"sub-title"},"体质类型解读",-1)),t("div",tt,[h(C,{options:P.value,width:"350px",height:"350px"},null,8,["options"]),t("div",et,[e[5]||(e[5]=t("div",{class:"l"},"您的体质类型为：",-1)),(c(!0),d(F,null,S(o.data.result.result,(s,r)=>(c(),d("div",{class:"v",key:r},n(s.category),1))),128))])])]),t("div",st,[e[9]||(e[9]=t("div",{class:"title"},"体质辨识画像",-1)),h(C,{options:j.value,width:"900px",height:"450px"},null,8,["options"])]),t("div",at,[e[10]||(e[10]=t("div",{class:"title"},"体制解析",-1)),(c(!0),d(F,null,S(o.data.explain,(s,r)=>(c(),d("div",{key:r},[t("div",ot,n(s.category),1),t("div",{style:{padding:"10px 70px 0"},innerHTML:s.overall_features},null,8,it),t("div",{style:{padding:"0 70px 0"},innerHTML:s.other_features},null,8,nt)]))),128))]),t("div",lt,[e[11]||(e[11]=t("div",{class:"title"},"AI建议",-1)),(c(!0),d(F,null,S(o.data.explain,(s,r)=>(c(),d("div",{key:r},[t("div",rt,n(s.category),1),t("div",{style:{padding:"10px 70px 10px"},innerHTML:s.explain},null,8,dt)]))),128))])],512)}}},ht=D(ct,[["__scopeId","data-v-86f84816"]]);export{ht as default};
