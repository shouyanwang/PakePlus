import{a as W}from"./index-DflO1dAi.js";import{s as J,q as K,_ as O,r as u,e as r,D as X,c as f,o as p,f as q,h as e,i as a,F as g,v as S,A as b,E as Z,j as m,t as w}from"./index-gubRP18q.js";import{g as h}from"./epartmene-D2Rd6sgX.js";import{g as ee}from"./scaleSet-MWCuoDeT.js";import{g as le}from"./user-D8WAOQH1.js";import ae from"./Report-BynKUct1.js";import"./jspdf.es.min-uZZ0fheg.js";import"./index-PIvSEPGS.js";function te(D={}){return J({url:"/bms/v1/scale/results",method:"GET",params:K(D)})}const oe={class:"search-form"},ne={class:"dialog-footer"},re={__name:"index",setup(D){const o=u({elder_name:"",phone:"",sex:"",epartmene_id:"",scale_set_id:"",admin_name:"",created_at:"",elder_status:"",page:1,per_page:10}),x=u([]),C=async()=>{const n=await h();x.value=n.data};C();const U=u([]);(async()=>{const n=await ee();U.value=n.data})(),C();const E=u([]);(async()=>{const n=await le();E.value=n.data})();const F=u(!1),P=u(0),R=u([]),L=()=>({backgroundColor:"#F6F8FF",color:"#C5C5C5"}),V=async()=>{F.value=!0;const n=await te(o.value);F.value=!1,R.value=n.data.data,P.value=n.data.total};V();const N=()=>{o.value.page=1,V()},y=u(!1),A=u({}),T=async n=>{const t=await W({id:n.scale_id,elder_id:n.elder_id});A.value=t.data,A.value.scale_name=n.scale.name,y.value=!0},k=u(null),$=async()=>{k.value&&await k.value.generatePDF()};return(n,t)=>{const B=r("el-input"),s=r("el-form-item"),d=r("el-col"),i=r("el-option"),c=r("el-select"),Y=r("el-row"),j=r("el-date-picker"),v=r("el-button"),z=r("el-form"),_=r("el-table-column"),G=r("el-table"),M=r("Dialog"),H=r("Pagination"),I=X("hasPermi");return p(),f(g,null,[q("div",oe,[e(z,{model:o.value,ref:"queryRef","label-position":"top"},{default:a(()=>[e(Y,{gutter:43},{default:a(()=>[e(d,{span:6},{default:a(()=>[e(s,{label:"姓名",prop:"elder_name"},{default:a(()=>[e(B,{modelValue:o.value.elder_name,"onUpdate:modelValue":t[0]||(t[0]=l=>o.value.elder_name=l),placeholder:"请输入长者姓名",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:6},{default:a(()=>[e(s,{label:"手机号",prop:"phone"},{default:a(()=>[e(B,{modelValue:o.value.phone,"onUpdate:modelValue":t[1]||(t[1]=l=>o.value.phone=l),placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:6},{default:a(()=>[e(s,{label:"性别",prop:"sex"},{default:a(()=>[e(c,{modelValue:o.value.sex,"onUpdate:modelValue":t[2]||(t[2]=l=>o.value.sex=l),placeholder:"请选择性别",clearable:""},{default:a(()=>[e(i,{label:"男",value:1}),e(i,{label:"女",value:2})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d,{span:6},{default:a(()=>[e(s,{label:"科室",prop:"epartmene_id"},{default:a(()=>[e(c,{modelValue:o.value.epartmene_id,"onUpdate:modelValue":t[3]||(t[3]=l=>o.value.epartmene_id=l),placeholder:"请选择科室",clearable:""},{default:a(()=>[(p(!0),f(g,null,S(x.value,l=>(p(),b(i,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Y,{gutter:43},{default:a(()=>[e(d,{span:6},{default:a(()=>[e(s,{label:"评估类型",prop:"scale_set_id"},{default:a(()=>[e(c,{modelValue:o.value.scale_set_id,"onUpdate:modelValue":t[4]||(t[4]=l=>o.value.scale_set_id=l),placeholder:"请选择评估类型",clearable:""},{default:a(()=>[(p(!0),f(g,null,S(U.value,l=>(p(),b(i,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d,{span:6},{default:a(()=>[e(s,{label:"评估医生",prop:"admin_name"},{default:a(()=>[e(c,{modelValue:o.value.admin_name,"onUpdate:modelValue":t[5]||(t[5]=l=>o.value.admin_name=l),placeholder:"请选择评估医生",clearable:""},{default:a(()=>[(p(!0),f(g,null,S(E.value,l=>(p(),b(i,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(d,{span:6},{default:a(()=>[e(s,{label:"评估时间",prop:"created_at"},{default:a(()=>[e(j,{modelValue:o.value.created_at,"onUpdate:modelValue":t[6]||(t[6]=l=>o.value.created_at=l),type:"date",placeholder:"请选择评估时间",style:{width:"100%"},"value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:6},{default:a(()=>[e(s,{label:"是否住院",prop:"elder_status"},{default:a(()=>[e(c,{modelValue:o.value.elder_status,"onUpdate:modelValue":t[7]||(t[7]=l=>o.value.elder_status=l),placeholder:"请选择是否住院",clearable:""},{default:a(()=>[e(i,{label:"已入住",value:1}),e(i,{label:"未入住",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(s,null,{default:a(()=>[Z((p(),b(v,{type:"primary",icon:"Search",onClick:N},{default:a(()=>t[12]||(t[12]=[m("查询")])),_:1,__:[12]})),[[I,["GET.scale/results"]]])]),_:1})]),_:1},8,["model"])]),e(G,{class:"base-info-table",data:R.value,"header-cell-style":L},{default:a(()=>[e(_,{prop:"name",label:"长者姓名",align:"center"},{default:a(({row:l})=>[m(w(l.elder.name),1)]),_:1}),e(_,{prop:"scale",label:"报告类型",align:"center"},{default:a(({row:l})=>[m(w(l.scale.name),1)]),_:1}),e(_,{prop:"scale_set",label:"评估类型",align:"center"},{default:a(({row:l})=>[m(w(l.scale_set.name),1)]),_:1}),e(_,{prop:"created_at",label:"时间",align:"center"}),e(_,{prop:"results",label:"评估结果",align:"center"}),e(_,{prop:"action",label:"操作",align:"center",width:"240"},{default:a(l=>[e(v,{type:"primary",plain:"",size:"default",onClick:Q=>T(l.row)},{default:a(()=>t[13]||(t[13]=[m("查看报告")])),_:2,__:[13]},1032,["onClick"]),e(v,{type:"primary",plain:"",size:"default",onClick:t[8]||(t[8]=Q=>n.$router.push("/workstation"))},{default:a(()=>t[14]||(t[14]=[m("重新评估")])),_:1,__:[14]})]),_:1})]),_:1},8,["data"]),e(M,{modelValue:y.value,"onUpdate:modelValue":t[9]||(t[9]=l=>y.value=l),title:"评估结果",width:"909"},{footer:a(()=>[q("div",ne,[e(v,{type:"primary",onClick:$},{default:a(()=>t[15]||(t[15]=[m("打印")])),_:1,__:[15]})])]),default:a(()=>[e(ae,{ref_key:"reportRef",ref:k,data:A.value},null,8,["data"])]),_:1},8,["modelValue"]),e(H,{total:P.value,layout:"total, prev, pager, next, jumper",page:o.value.page,"onUpdate:page":t[10]||(t[10]=l=>o.value.page=l),limit:o.value.per_page,"onUpdate:limit":t[11]||(t[11]=l=>o.value.per_page=l),onPagination:V},null,8,["total","page","limit"])],64)}}},ge=O(re,[["__scopeId","data-v-ead71c68"]]);export{ge as default};
