import{_ as pe,d as me,a as fe,r as c,w as ge,e as u,A as y,o as d,i as t,f as l,h as s,c as _,F as w,v as V,p as o,x as ye,t as v,j as n,R as M}from"./index-DWZ4RG6E.js";import{p as be}from"./index-ZBJUHKvz.js";import{a as we,g as Ve}from"./index-Bch2Pa7B.js";import{g as ke}from"./baseInfo-cmMGvD1t.js";import{g as Ae}from"./epartmene-DD5gf4-r.js";import{g as xe}from"./roles-DRW-LL0S.js";import{g as Ce}from"./user-CEYqzk3X.js";import{g as ze}from"./scaleSet-Bl45bU-l.js";import{a as $e}from"./index-BwgIcDpR.js";const Ee={class:"report-view"},De={class:"user-wrap"},Re={class:"form-box"},Se={class:"type-wrap"},Ue=["onClick"],We={class:"info-wrap"},Be={class:"info-item"},Le={class:"value"},je={class:"info-item"},Fe={key:0,class:"value"},Ie={key:1,class:"value"},Ne={class:"info-item"},Te={class:"value"},Oe={class:"info-item"},qe={key:0,class:"value"},Pe={key:1},Ge={class:"doctor-wrap"},He={class:"doctor-title"},Je={class:"doctor-title"},Ke={key:0},Me={class:"flex-center"},Qe={class:"doctor-title"},Xe={class:"doctor-title"},Ye={class:"warn-wrap"},Ze={class:"doctor-title"},he={class:"dialog-footer"},el={__name:"AddReport30",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","success"],setup(Q,{emit:X}){const{proxy:m}=me(),Y=fe(),F=Q,I=X,k=c(F.modelValue);ge(()=>F.modelValue,async i=>{i==!0&&(m.$modal.loading("加载中..."),await ee(),await W(),await ae(),await se(),await te()),m.$modal.closeLoading(),k.value=i});const Z=()=>{I("update:modelValue",!1)};c(!1);const r=c({elder_id:"",scale_set_id:"",type:"",result_ids:"",capability_level:"",syndrome:"",final_result:""}),C=c({status:1,epartmene_id:"",page:1,per_page:1e3}),h=c([{name:"已入住",value:1},{name:"未入住",value:0}]),N=c([]),ee=async()=>{const i=await Ae();N.value=i.data},p=c({}),z=c([]),T=async()=>{if(r.value.elder_id){p.value;const i=await ke({id:r.value.elder_id});p.value=i.data;const e=await $e({id:r.value.elder_id,type:30});e.data.total>0?z.value=e.data.data:z.value=[{id:"",category:"",scale_id:"",status:"",score:"",created_at:"",results:"",scale_set_id:"",scale:{id:"",name:"",category_text:[],tags_text:[]},scale_set:{id:"",name:""}}]}else p.value={}},O=c([]),W=async()=>{r.value.elder_id="",await T();const i=await we(C.value);O.value=i.data.data},le=(i,e)=>{C.value.status=i.value,W()},$=c([]),ae=async()=>{const i=await xe({is_ca:1});$.value=i.data,$.value.forEach(async e=>{const{data:b}=await Ce({role_id:e.id});e.option=b})},q=c([]),se=async()=>{const i=await ze();q.value=i.data},P=c([]),E=c([]),te=async()=>{const i=await Ve({type:"syndrome"});P.value=i.data.syndrome},oe=()=>{Y.push("/workstation")},ne=()=>{k.value=!1},de=async()=>{if(!r.value.elder_id){m.$modal.msgWarning("请选择长者");return}for(const e of $.value)if(!e.select){m.$modal.msgWarning("请选择医药师");return}const i=$.value.map(e=>({role_id:e.id,user_id:e.select}));if(z.value.length==0){m.$modal.msgWarning("请选择评估量表");return}if(r.value.capability_level===""){m.$modal.msgWarning("请填写评估能力等级");return}if(!r.value.scale_set_id){m.$modal.msgWarning("请填写报告类型");return}if(E.value.length==0){m.$modal.msgWarning("请选择老年综合症罹患项");return}if(r.value.final_result==""){m.$modal.msgWarning("请填写护理需求等级");return}await be({...r.value,type:30,participant:i,syndrome:E.value.join(","),result_ids:z.value.map(e=>e.id).join(",")}),m.$modal.msgSuccess("添加成功"),k.value=!1,I("success")};return(i,e)=>{const b=u("el-col"),R=u("el-option"),S=u("el-select"),B=u("el-form-item"),L=u("el-row"),A=u("svg-icon"),x=u("el-table-column"),j=u("el-button"),ie=u("el-table"),f=u("el-radio"),G=u("el-radio-group"),re=u("el-checkbox"),ue=u("el-checkbox-group"),ce=u("el-form"),_e=u("Dialog");return d(),y(_e,{modelValue:o(k),"onUpdate:modelValue":e[6]||(e[6]=U=>M(k)?k.value=U:null),width:"1205",title:"新增报告",onClose:Z},{footer:t(()=>[l("div",he,[s(j,{onClick:ne},{default:t(()=>e[32]||(e[32]=[n("取消")])),_:1,__:[32]}),s(j,{type:"primary",onClick:de},{default:t(()=>e[33]||(e[33]=[n(" 保存 ")])),_:1,__:[33]})])]),default:t(()=>[l("div",Ee,[e[31]||(e[31]=l("div",{class:"report-view-title"},"护理需求等级评定",-1)),s(ce,{"label-position":"top"},{default:t(()=>{var U,H,J,K;return[l("div",De,[l("div",Re,[s(L,{gutter:42},{default:t(()=>[s(b,{span:8},{default:t(()=>[l("div",Se,[(d(!0),_(w,null,V(o(h),(a,g)=>(d(),_("div",{class:ye(["type-item",{active:o(C).status==a.value}]),key:g,onClick:D=>le(a,g)},v(a.name),11,Ue))),128))])]),_:1}),s(b,{span:8},{default:t(()=>[s(B,null,{default:t(()=>[s(S,{modelValue:o(C).epartmene_id,"onUpdate:modelValue":e[0]||(e[0]=a=>o(C).epartmene_id=a),placeholder:"请选择所属科室",onChange:W},{default:t(()=>[(d(!0),_(w,null,V(o(N),(a,g)=>(d(),y(R,{key:g,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),s(b,{span:8},{default:t(()=>[s(B,null,{default:t(()=>[s(S,{modelValue:o(r).elder_id,"onUpdate:modelValue":e[1]||(e[1]=a=>o(r).elder_id=a),placeholder:"请选择长者",onChange:T},{default:t(()=>[(d(!0),_(w,null,V(o(O),(a,g)=>(d(),y(R,{key:g,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),l("div",We,[l("div",Be,[e[7]||(e[7]=l("div",{class:"label"},"年龄",-1)),l("div",Le,v(o(p).age||"--"),1)]),l("div",je,[e[8]||(e[8]=l("div",{class:"label"},"性别",-1)),o(p).sex?(d(),_("div",Fe,v(i.genderFormat(o(p).sex)||"--"),1)):(d(),_("div",Ie,"--"))]),l("div",Ne,[e[9]||(e[9]=l("div",{class:"label"},"科别",-1)),l("div",Te,v(((U=o(p).epartmene)==null?void 0:U.name)||"--"),1)]),l("div",Oe,[e[10]||(e[10]=l("div",{class:"label"},"床位号",-1)),o(p).bed?(d(),_("div",qe,v((H=o(p).building)==null?void 0:H.name)+"/ "+v((J=o(p).room)==null?void 0:J.name)+"/ "+v((K=o(p).bed)==null?void 0:K.name),1)):(d(),_("div",Pe,"--"))])])]),l("div",Ge,[l("div",He,[l("div",null,[s(A,{"icon-class":"doctor",class:"svg-icon"}),e[11]||(e[11]=n(" 选择医药师 "))])]),s(L,{gutter:63},{default:t(()=>[(d(!0),_(w,null,V(o($),(a,g)=>(d(),y(b,{span:12,key:g},{default:t(()=>[s(B,{label:a.name},{default:t(()=>[s(S,{modelValue:a.select,"onUpdate:modelValue":D=>a.select=D,placeholder:"请选择"},{default:t(()=>[(d(!0),_(w,null,V(a.option,(D,ve)=>(d(),y(R,{key:ve,label:D.name,value:D.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1}),l("div",Je,[l("div",null,[s(A,{"icon-class":"star",class:"svg-icon"}),e[12]||(e[12]=n(" 各评估量表得分 "))])]),s(ie,{data:o(z),border:""},{default:t(()=>[s(x,{type:"index",label:"序号",width:"120",align:"center"}),s(x,{prop:"name",label:"量表名称",align:"center"},{default:t(({row:a})=>[n(v(a.scale.name||"--"),1)]),_:1}),s(x,{prop:"score",label:"得分",align:"center"},{default:t(({row:a})=>[n(v(a.score||"--"),1)]),_:1}),s(x,{prop:"type",label:"评估类型",align:"center"},{default:t(({row:a})=>[n(v(a.scale_set.name||"--"),1)]),_:1}),s(x,{prop:"created_at",label:"评估时间",align:"center"},{default:t(({row:a})=>[n(v(a.created_at||"--"),1)]),_:1}),s(x,{prop:"results",label:"结果",align:"center"},{default:t(({row:a})=>[a.id?(d(),_("span",Ke,v(a.results),1)):(d(),y(j,{key:1,type:"primary",plain:"",onClick:oe},{default:t(()=>e[13]||(e[13]=[n("立即评估")])),_:1,__:[13]}))]),_:1})]),_:1},8,["data"]),e[29]||(e[29]=l("div",{class:"flex-center"},[l("div",{class:"sub-title"},"评估能力等级")],-1)),s(G,{modelValue:o(r).capability_level,"onUpdate:modelValue":e[2]||(e[2]=a=>o(r).capability_level=a)},{default:t(()=>[s(f,{value:0,size:"large"},{default:t(()=>e[14]||(e[14]=[n("0级能力完好")])),_:1,__:[14]}),s(f,{value:1,size:"large"},{default:t(()=>e[15]||(e[15]=[n("1级轻度失能")])),_:1,__:[15]}),s(f,{value:2,size:"large"},{default:t(()=>e[16]||(e[16]=[n("2级中度失能")])),_:1,__:[16]}),s(f,{value:3,size:"large"},{default:t(()=>e[17]||(e[17]=[n("3级重度失能")])),_:1,__:[17]}),s(f,{value:4,size:"large"},{default:t(()=>e[18]||(e[18]=[n("4级完全失能")])),_:1,__:[18]})]),_:1},8,["modelValue"]),l("div",Me,[e[19]||(e[19]=l("div",{class:"sub-title"},"报告类型",-1)),s(S,{modelValue:o(r).scale_set_id,"onUpdate:modelValue":e[3]||(e[3]=a=>o(r).scale_set_id=a),placeholder:"请选择",style:{width:"515px"}},{default:t(()=>[(d(!0),_(w,null,V(o(q),a=>(d(),y(R,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",Qe,[l("div",null,[s(A,{"icon-class":"plus",class:"svg-icon"}),e[20]||(e[20]=n(" 老年综合症罹患项 "))])]),s(ue,{modelValue:o(E),"onUpdate:modelValue":e[4]||(e[4]=a=>M(E)?E.value=a:null)},{default:t(()=>[s(L,null,{default:t(()=>[(d(!0),_(w,null,V(o(P),a=>(d(),y(b,{key:a.key,span:4},{default:t(()=>[s(re,{label:a.value,value:a.key},null,8,["label","value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"]),l("div",Xe,[l("div",null,[s(A,{"icon-class":"medal",class:"svg-icon"}),e[21]||(e[21]=n(" 护理需求等级评定依据 "))])]),e[30]||(e[30]=l("div",{class:"assess-list"},[l("div",{class:"assess-item"},[l("div",{class:"label"},"评估能力等级： "),l("div",{class:"result success"},[l("div",{class:"dot success"}),l("span",null,"能力完好")]),l("div",{class:"value"}," 老年综合征罹患项数：1-2项  护理需求等级为0级(能力完好)，3-5项  护理需求等级为1级(轻度失能) ")]),l("div",{class:"assess-item"},[l("div",{class:"label"},"评估能力等级： "),l("div",{class:"result warning"},[l("div",{class:"dot warning"}),l("span",null,"轻度受损")]),l("div",{class:"value"}," 老年综合征罹患项数：1-2项  护理需求等级为0级(能力完好)，3-5项  护理需求等级为1级(轻度失能) ")]),l("div",{class:"assess-item"},[l("div",{class:"label"},"评估能力等级： "),l("div",{class:"result danger"},[l("div",{class:"dot danger"}),l("span",null,"中度受损")]),l("div",{class:"value"}," 老年综合征罹患项数：1-2项  护理需求等级为0级(能力完好)，3-5项  护理需求等级为1级(轻度失能) ")]),l("div",{class:"assess-item"},[l("div",{class:"label"},"评估能力等级： "),l("div",{class:"result danger-2"},[l("div",{class:"dot danger-2"}),l("span",null,"重度受损")]),l("div",{class:"value"}," 老年综合征罹患项数：1-2项  护理需求等级为0级(能力完好)，3-5项  护理需求等级为1级(轻度失能) ")])],-1)),l("div",Ye,[s(A,{"icon-class":"warn",class:"svg-icon"}),e[22]||(e[22]=n(" 老年综合征罹患项数：5项以上 护理需求等级为4级(完全失能) "))]),l("div",Ze,[l("div",null,[s(A,{"icon-class":"triangle",class:"svg-icon"}),e[23]||(e[23]=n(" 护理需求等级 "))])]),s(G,{modelValue:o(r).final_result,"onUpdate:modelValue":e[5]||(e[5]=a=>o(r).final_result=a)},{default:t(()=>[s(f,{value:0,size:"large"},{default:t(()=>e[24]||(e[24]=[n("0级能力完好")])),_:1,__:[24]}),s(f,{value:1,size:"large"},{default:t(()=>e[25]||(e[25]=[n("1级轻度失能")])),_:1,__:[25]}),s(f,{value:2,size:"large"},{default:t(()=>e[26]||(e[26]=[n("2级中度失能")])),_:1,__:[26]}),s(f,{value:3,size:"large"},{default:t(()=>e[27]||(e[27]=[n("3级重度失能")])),_:1,__:[27]}),s(f,{value:4,size:"large"},{default:t(()=>e[28]||(e[28]=[n("4级完全失能")])),_:1,__:[28]})]),_:1},8,["modelValue"])])]}),_:1})])]),_:1},8,["modelValue"])}}},ul=pe(el,[["__scopeId","data-v-272e4706"]]);export{ul as default};
