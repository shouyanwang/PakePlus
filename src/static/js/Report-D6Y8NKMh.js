import{E as H,h as P}from"./jspdf.es.min-uZZ0fheg.js";import{E}from"./index-PIvSEPGS.js";import{_ as I,r as F,w as M,c as h,o as u,f as t,h as D,t as a,F as L,v as T,Q as z}from"./index-gubRP18q.js";const O={class:"pageTitle"},W={class:"flex_between flex_wrap baseInfo"},B={class:"width33 flex_start"},N={class:"width33 flex_start"},R={class:"width33 flex_start"},A={class:"width33 flex_start"},j={class:"width33 flex_start"},V=["innerHTML"],Y={class:"pageTable"},G={cellspacing:"0",cellpadding:"0"},J={key:0,width:"50%"},Q={key:1,width:"50%"},U={width:"50%"},X={class:"pageTable pageTable1"},Z={cellspacing:"0",cellpadding:"0"},q={width:"50%"},K={width:"50%"},$=["innerHTML"],tt={class:"pageEnd flex_end"},et={class:"con"},at={__name:"Report",props:{data:{type:Object,default:()=>{}}},setup(s,{expose:k}){var S;const m=s,C=F({series:[{type:"gauge",radius:"120%",center:["50%","70%"],startAngle:180,endAngle:0,min:0,max:100,splitNumber:10,itemStyle:{color:"#58D9F9",shadowColor:"rgba(0,138,255,0.45)",shadowBlur:10,shadowOffsetX:2,shadowOffsetY:2},progress:{show:!0,roundCap:!0,width:18},pointer:{icon:"path://M2090.36389,615.30999 L2090.36389,615.30999 C2091.48372,615.30999 2092.40383,616.194028 2092.44859,617.312956 L2096.90698,728.755929 C2097.05155,732.369577 2094.2393,735.416212 2090.62566,735.56078 C2090.53845,735.564269 2090.45117,735.566014 2090.36389,735.566014 L2090.36389,735.566014 C2086.74736,735.566014 2083.81557,732.63423 2083.81557,729.017692 C2083.81557,728.930412 2083.81732,728.84314 2083.82081,728.755929 L2088.2792,617.312956 C2088.32396,616.194028 2089.24407,615.30999 2090.36389,615.30999 Z",length:"70%",width:12,offsetCenter:[0,"5%"]},axisLine:{roundCap:!0,lineStyle:{width:16}},axisTick:{splitNumber:2,lineStyle:{width:1,color:"#999"},length:8},splitLine:{length:12,lineStyle:{width:2,color:"#999"},distance:5},axisLabel:{distance:25,color:"#999",fontSize:14},detail:{backgroundColor:"#fff",width:"80%",lineHeight:40,height:40,offsetCenter:[0,"30%"],formatter:function(p){return"{label|得分:}{value|"+p.toFixed(0)+"}"},rich:{label:{fontSize:18,fontWeight:"bolder",color:"#666",padding:[0,5,0,0]},value:{fontSize:24,fontWeight:"bolder",color:"#333"}}},data:[{value:(S=m.data)==null?void 0:S.score}]}]});M(()=>m.data,async()=>{m.data&&(C.value.series[0].data[0].value=m.data.score)},{immediate:!0,deep:!0});const y=F(null);return k({generatePDF:async()=>{const p=z.service({lock:!0,text:"正在生成PDF，请稍候..."}),e=y.value,i=new H({orientation:"p",unit:"mm",format:"a4"}),v=i.internal.pageSize.getHeight(),x=i.internal.pageSize.getWidth(),d=15,g=v-2*d,l=await P(e,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#FFFFFF",scrollY:0}),o=x-2*d,b=l.height*o/l.width,_=Math.ceil(b/g);for(let r=0;r<_;r++){r>0&&i.addPage();const f=r*g*(l.width/o),c=Math.min(g*(l.width/o),l.height-f),n=document.createElement("canvas");n.width=l.width,n.height=c,n.getContext("2d").drawImage(l,0,f,l.width,c,0,0,l.width,c),i.addImage(n.toDataURL("image/jpeg",.95),"JPEG",d,d,o,c*(o/l.width))}window.open(i.output("bloburl")),p.close()}}),(p,e)=>{var i,v,x,d,g,l,o,b,_,r,f,c;return u(),h("div",{ref_key:"elementToPrint",ref:y,class:"pageCon"},[t("h1",O,a((i=s.data)==null?void 0:i.scale_name),1),e[4]||(e[4]=t("div",{class:"flex_start pageStit"},[t("span"),t("h2",null,"基本信息")],-1)),t("div",W,[t("div",B,[t("p",null,"姓名："+a((v=s.data.elder)==null?void 0:v.name),1)]),t("div",N,[t("p",null,"性别： "+a(p.genderFormat((x=s.data.elder)==null?void 0:x.sex)),1)]),t("div",R,[t("p",null,"生日："+a((d=s.data.elder)==null?void 0:d.date_birth),1)]),t("div",A,[t("p",null,"年龄："+a((g=s.data.elder)==null?void 0:g.age)+"岁",1)]),t("div",j,[t("p",null," 床位："+a((l=s.data.elder)==null?void 0:l.building.name)+"/"+a((o=s.data.elder)==null?void 0:o.room.name)+"/"+a((b=s.data.elder)==null?void 0:b.bed.name),1)]),e[0]||(e[0]=t("div",{class:"width33 flex_start"},null,-1))]),e[5]||(e[5]=t("div",{class:"flex_start pageStit"},[t("span"),t("h2",null,"测试目的")],-1)),t("div",{class:"pageInfo",innerHTML:(_=s.data)==null?void 0:_.desc},null,8,V),e[6]||(e[6]=t("div",{class:"flex_start pageStit"},[t("span"),t("h2",null,"测试结果")],-1)),D(E,{options:C.value,width:"500px",height:"250px"},null,8,["options"]),e[7]||(e[7]=t("div",{class:"flex_start pageStit"},[t("span"),t("h2",null,"参考范围")],-1)),t("div",Y,[t("table",G,[e[1]||(e[1]=t("thead",null,[t("tr",null,[t("th",{width:"50%"},"得分区间"),t("th",{width:"50%"},"结果解释")])],-1)),t("tbody",null,[(u(!0),h(L,null,T((r=s.data)==null?void 0:r.resutl_collect,(n,w)=>(u(),h("tr",{key:w},[n.min==n.max?(u(),h("td",J,a(n.max),1)):(u(),h("td",Q,a(n.min)+"-"+a(n.max),1)),t("td",U,a(n.result),1)]))),128))])])]),e[8]||(e[8]=t("div",{class:"flex_start pageStit"},[t("span"),t("h2",null,"重点提示")],-1)),t("div",X,[t("table",Z,[e[2]||(e[2]=t("thead",null,[t("tr",null,[t("th",{width:"50%"},"题目"),t("th",{width:"50%"},"选项")])],-1)),t("tbody",null,[(u(!0),h(L,null,T((f=s.data)==null?void 0:f.elderTopicCollect,(n,w)=>(u(),h("tr",{key:w},[t("td",q,a(w+1)+"、"+a(n.topic),1),t("td",K,a(n.option.no)+"、（"+a(n.option.score)+"分）"+a(n.option.option),1)]))),128))])])]),e[9]||(e[9]=t("div",{class:"flex_start pageStit"},[t("span"),t("h2",null,"AI建议")],-1)),t("div",null,[t("p",{class:"pageInfo",innerHTML:(c=s.data)==null?void 0:c.explain},null,8,$)]),t("div",tt,[e[3]||(e[3]=t("div",{class:"con"},"签字：",-1)),t("div",et,"日期： "+a(s.data.updated_at),1)])],512)}}},ot=I(at,[["__scopeId","data-v-d8a5dabf"]]);export{ot as default};
